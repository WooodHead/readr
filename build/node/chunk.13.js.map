{"version":3,"sources":["../.././src/routes/Signin/Signin.tsx","webpack:///./src/utils/validation.ts?3c04","../.././src/routes/Signin/components/SigninForm.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAwC;AACH;AACF;AACa;AACD;AACS;AACR;AAUhD;;IAAa;;;AACX,oBAAiB;AACV;;oHAAO;;AACR,cAAa,eAAO,MAAa,aACvC;;AAEY;;;;qCAAK;AACT,qEAAU,UAAM,MAAK,KAAI;AACzB,qBAAM,MAAiB,iBAAQ,SAAW,WAAO;AACb;AACjB;AACK;AAChB;AACP;AACD,qBAAM,MACZ;AAAE,eAAM,MAAK,GAAJ;AACA,wBAAM,MAAK;AACd,qBAAM,MAAiB,iBAAI,IAAQ,SACzC;AACF;AAEM;;;;AACG,mBACL,4DAAa,6EAAM,OAAK,QACtB,qEAAc,WAAoB,uBAChC,oEAAa,WAAa,gBAAU,6BACpC,4DAAW,2EACH,QAAM,KACZ,iBACF,mEAAY,WAAO,4CAAM,4DAAK,sDAAG,IAAU,aAInD;AACD;;;;EAlCwC;;AAoCzC;AAEgB,kBAAO,MAAW,WAAa;AACvC,UAAO,MACX;AAHQ,CAAD,CADW,EAKpB,EAAkB,8EACnB,0EAAQ,Q;;;;;;;;;;;AC1Da;AAQR,oBAA2B,QAAiB;AACxD,UAAY,SAAU;AAErB,mDAAK,KAAQ,QAAQ,QAAI;AACrB,YAAC,CAAO,OAAM,MAAE;AACX,mBAAQ,OAChB;AACF;AAAE;AAEI,WACR;AAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClBuC;AACH;AACD;AACe;AACK;AACN;AAwBlD;AAAiB;;AAEf,wBAAiB;AACV;;uHACP;AAEM;;;;;AACJ,kBAAM,EACE,QAAE,EAAO,OAAY,YACf,cAEb,WAAO,KAAM;AAEP,mBACL,yEACE,4DAAM,iFAAY,aAAS,YAAc,SACzC,4DAAM,iFAAY,aAAK,MAAK,MAAW,cAAiB,wEACjD,oEACA,OAAO,QACL,sBAAmB;AAClB,2BACR;AAAE,iBAFmB,GAFvB,EAON;AACD;;;;EAzBkD;AAAnC;AANV,UAAU;AACR,YAAE,CAAQ,SAAa;AACrB,cAAQ;AACR,eAAW,0FACnB;AACA;AANI,CAAD,IAgCJ;AAED,oIACE,CAAM,OAAU;AACR;AACS,uBAAU,SAAc;AAC9B,iBAAO,MAAQ,QAE1B;AAJS;AAIR,CANmB,EAOpB,EACD,gFAAY,Y","file":"chunk.13.js","sourcesContent":["import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport { Link } from 'react-router'\nimport { sendNotification } from '../../actions'\nimport { loadSession } from '../../actions/api'\nimport DocContainer from '../../components/DocContainer'\nimport SigninForm from './components/SigninForm'\nimport webAPI from '../../webAPI'\n// import helpers from '../../helpers'\n\ninterface Props {\n  sendNotification?: any\n  userAuth?: any\n  loadSession?: typeof loadSession\n}\n\nclass Signin extends Component<Props, {}> {\n  constructor(props) {\n    super(props)\n    this.handleSubmit = this.handleSubmit.bind(this)\n  }\n\n  handleSubmit(data) {\n    webAPI.userLogin(data).then(res => {\n      this.props.sendNotification('登录成功！', 'success', 1500)\n      // this.props.loadSession().then(() => {\n      //   setTimeout(() => {\n      //     helpers.redirect('/')\n      //   }, 600)\n      // })\n      this.props.loadSession()\n    }).catch((err) => {\n      console.error(err)\n      this.props.sendNotification(err.message, 'error')\n    })\n  }\n\n  render() {\n    return (\n      <DocContainer title=\"登录\">\n        <div className=\"content-container\">\n          <h1 className=\"page-title\">欢迎回来</h1>\n          <SigninForm\n            onSave={this.handleSubmit}\n          />\n          <p className=\"hint\">没有账号？<Link to=\"/signup\">注册</Link></p>\n        </div>\n      </DocContainer>\n    )\n  }\n}\n\nexport default connect<{}, {}, Props>(\n  state => ({\n    notification: state.components.notification,\n    user: state.user\n  }),\n  { sendNotification, loadSession }\n)(Signin)\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/Signin/Signin.tsx","import _ from 'lodash'\n\ntype Config = {\n  validators: {\n    [key: string]: [(value: string) => boolean, string]\n  }[]\n}\n\nexport default function validation(values, config?: Config) {\n  const errors: any = {}\n\n  _.keys(values).forEach(key => {\n    if (!values[key]) {\n      errors[key] = `不能为空！`\n    }\n  })\n\n  return errors\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/validation.ts","import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport form from 'better-redux-form'\nimport { sendNotification } from '../../../actions'\nimport { Input, Button } from '../../../components/form'\nimport validation from '../../../utils/validation'\n\ninterface Props {\n  initialValues?: any\n  onSave: (data: any) => void\n}\n\ninterface AllProps extends Props {\n  routing: any\n  sendNotification: any\n  handleSubmit: any\n  fields: any\n}\n\ninterface State {\n}\n\n@form({\n  form: 'signin',\n  fields: ['login', 'password'],\n  validate: values => {\n    return validation(values)\n  }\n})\nclass SigninForm extends Component<AllProps, State> {\n\n  constructor(props) {\n    super(props)\n  }\n\n  render() {\n    const {\n      fields: { login, password },\n      handleSubmit,\n      onSave\n    } = this.props\n\n    return (\n      <div>\n        <Input placeholder=\"用户名/邮箱\" {...login} />\n        <Input placeholder=\"密码\" type=\"password\" {...password} />\n        <Button\n          color=\"blue\"\n          onClick={handleSubmit(data => {\n            onSave(data)\n          })}>登录</Button>\n      </div>\n    )\n  }\n}\n\nexport default connect<{}, {}, Props>(\n  (state, ownProps) => {\n    return {\n      initialValues: ownProps.initialValues,\n      routing: state.routing.locationBeforeTransitions\n    }\n  },\n  { sendNotification }\n)(SigninForm)\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/Signin/components/SigninForm.tsx"],"sourceRoot":""}