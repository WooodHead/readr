webpackJsonp([5],{64:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=n(1),f=o(c),s=n(4),p=o(s),d=n(8),y=o(d),h=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":u(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},b=n(71),g=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={dynamicText:""},n}return a(t,e),l(t,[{key:"componentDidMount",value:function(){var e=this;this.intervalId=setInterval(function(){3===e.state.dynamicText.length?e.setState({dynamicText:""}):e.setState({dynamicText:e.state.dynamicText+"."})},500)}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalId)}},{key:"render",value:function(){var e=this.props,t=e.text,n=e.center,o=this.state.dynamicText,r=(0,y["default"])({"loading-wrap--center":n,"loading-wrap":!n});return f["default"].createElement("div",{styleName:r},f["default"].createElement("span",{styleName:"text-loading"},t+o))}}]),t}(c.Component);g=h([(0,p["default"])(b)],g),g.defaultProps={text:"加载中"},t["default"]=g},65:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(64),i=o(r);t["default"]=i["default"]},71:function(e,t){e.exports={"text-loading":"text-loading_3efqh","loading-wrap":"loading-wrap_htyYz","loading-wrap--center":"loading-wrap--center_3PEIh"}},179:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=n(1),f=o(c),s=n(4),p=o(s),d=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":u(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},y=n(215),h=function(e){function t(e){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return a(t,e),l(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.props,n=t.value,o=t.className;"string"==typeof this.props.value&&(n="1"===n||"true"===n);var r=Boolean(n)?"on":"off";return f["default"].createElement("div",{className:o||"",styleName:"switcher-wrap"},this.props.title&&f["default"].createElement("span",null,this.props.title),f["default"].createElement("div",{onClick:function(t){if(e.props.onChange){var n=void 0;if(e.props.options){var o=e.props.options.map(function(e){return e.value}).indexOf(e.props.value);1===o?n=e.props.options[0].value:0===o?n=e.props.options[1].value:(n=e.props.options[0].value,console.error("当前数据有误，将使用默认数据！"))}else"string"==typeof e.props.value?console.error("没有给 options 时必须使用布尔型的 value！"):n=!e.props.value;e.props.onChange(n)}},styleName:"switcher--"+r},f["default"].createElement("div",{styleName:"switcher-button"}),f["default"].createElement("div",{styleName:"switcher-track"})))}}]),t}(c.Component);h=d([(0,p["default"])(y,{allowMultiple:!0})],h),t["default"]=h},180:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(179),i=o(r);t["default"]=i["default"]},215:function(e,t){e.exports={"switcher-wrap":"switcher-wrap_3UMAU",switcher:"switcher_G3n4_","switcher--off":"switcher--off_1EoOU","switcher--on":"switcher--on_2xiwO","switcher-button":"switcher-button_2kHGL","switcher-track":"switcher-track_xvhjg"}},275:function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=n(1),s=r(f),p=n(584),d=r(p),y=n(585),h=o(y),b=n(5),g=r(b),m=n(8),v=r(m),w=n(4),_=r(w),P=n(590),O=r(P),k=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":c(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},j=n(823),E=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={scrollTop:0,currentPage:1},n.handleScroll=n.handleScroll.bind(n),n.deboundedHandleScroll=g["default"].debounce(n.handleScroll,200,{maxWait:1e3}),n}return l(t,e),u(t,[{key:"handleScroll",value:function(){if(!this.props.isCalcMode){var e=this.calcPages(),t=e.pages,n=e.totalHeight,o=this.props.onProgressChange,r=document.body.scrollTop,i=h.percentageToPage(r/n,t.length);o&&o(r/n),this.setState({currentPage:i})}}},{key:"addEventListeners",value:function(){window.addEventListener("scroll",this.deboundedHandleScroll)}},{key:"removeEventListeners",value:function(){window.removeEventListener("scroll",this.deboundedHandleScroll),console.log("removed")}},{key:"calcPages",value:function(){var e=this.props,t=e.nodeHeights,n=e.nodes,o=e.pageHeight,r=h.groupNodesByPage(n,t,o);return{pages:r,totalHeight:r.length*o}}},{key:"componentDidMount",value:function(){var e=this.props,t=e.pageHeight,n=e.initialPage,o=e.initialProgress,r=this.calcPages(),i=r.totalHeight,a=0;o?a=i*o:n&&(a=t*(n-1)),document.body.scrollTop=a,this.addEventListeners()}},{key:"componentWillUnmount",value:function(){this.removeEventListeners()}},{key:"render",value:function(){var e=this,t=this.calcPages(),n=t.pages,o=t.totalHeight,r=this.state.currentPage,i=this.props,a=i.pageCount,l=i.pageHeight,u=i.fluid,c=i.showPageInfo,f=i.isCalcMode,p=(0,v["default"])({pages:!u,"pages--fluid":u}),y=void 0,h=void 0;return f?(y=0,h=1):(y=r-Math.ceil(a/2),y=y<0?0:y,h=y+a),s["default"].createElement("div",null,s["default"].createElement("ul",{ref:function(t){e.bookPageListDom=t},styleName:p,style:{height:o}},g["default"].slice(n,y,h).map(function(t,n){return s["default"].createElement(d["default"],{key:n,page:t,pageHeight:l,fluid:u,ref:function(t){e.bookPage=t}})})),s["default"].createElement(O["default"],{visible:c,current:r,total:n.length}))}}]),t}(f.Component);E=k([(0,_["default"])(j)],E),t["default"]=E},584:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=n(1),f=o(c),s=n(8),p=o(s),d=n(4),y=o(d),h=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":u(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},b=n(824),g=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),l(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.page,o=n.nodes,r=n.meta,i=t.pageHeight,a=t.fluid,l={position:"absolute",top:i*(r.pageNo-1),height:i||"auto"},u=(0,p["default"])({page:!a,"page--fluid":a});return f["default"].createElement("li",{styleName:u,style:l},f["default"].createElement("div",{style:{marginTop:r.offset},styleName:"content",dangerouslySetInnerHTML:{__html:o.join("")},ref:function(t){e.bookPageDom=t}}),f["default"].createElement("div",{styleName:"page-no"},r.pageNo))}}]),t}(c.Component);g=h([(0,y["default"])(b)],g),t["default"]=g},585:function(e,t){"use strict";function n(e){var t=e.pageIndex,n=e.pageHeight,o=e.nodeHeights,r=0,i=0,a=void 0;if(0!==t){for(var l=0;l<=n*t;)l+=o[i],i++;r=l-o[i-1]-t*n,a=i-1}else a=0;return{offset:r,nodeStartIndex:a}}function o(e){var t=e.pageIndex,o=e.nodes,r=e.pageHeight,i=e.nodeHeights,a=n({pageIndex:t,pageHeight:r,nodeHeights:i}),l=a.offset,u=a.nodeStartIndex,c=u,f=void 0,s=[],p=l+i[u];if(c++,p<r){for(;p<=r&&c!==o.length;)p+=i[c],c++;f=c-1}else f=u;for(var d=u;d<=f&&d<=o.length-1;d++)s.push(o[d]);return{pageNodes:s,offset:l}}function r(e,t,n){var r=[],i=t.reduce(function(e,t){return e+t},0),a=Math.ceil(i/n);if(console.log("todo: group nodes"),0===t.length)return[{nodes:e,meta:{pageNo:1,offset:0}}];for(var l=0;l<a;l++){var u=o({pageIndex:l,nodes:e,nodeHeights:t,pageHeight:n}),c=u.pageNodes,f=u.offset;r.push({nodes:c,meta:{pageNo:l+1,offset:f}})}return r}function i(e,t){return e>1?(console.error("Wrong parameter!"),null):parseInt(e*t)+1}Object.defineProperty(t,"__esModule",{value:!0}),t.groupNodesByPage=r,t.percentageToPage=i},586:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=n(1),c=o(u),f=n(275),s=o(f),p=function(e){function t(e){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return a(t,e),l(t,[{key:"getContentHtml",value:function(){return this.bookPageList.bookPage.bookPageDom}},{key:"render",value:function(){var e=this,t=this.props,n=t.fluid,o=t.nodes;return c["default"].createElement(s["default"],{fluid:n,nodes:o,nodeHeights:[],pageCount:1,pageHeight:0,isCalcMode:!0,ref:function(t){e.bookPageList=t}})}}]),t}(u.Component);t["default"]=p},587:function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=n(1),s=r(f),p=n(13),d=n(275),y=r(d),h=n(588),b=o(h),g=n(10),m=n(5),v=r(m),w=n(591),_=r(w),P=n(586),O=r(P),k=n(4),j=r(k),E=n(66),S=r(E),M=n(108),C=r(M),R=n(45),T=r(R),H=n(32),N=o(H),x=n(65),I=r(x),L=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":c(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},V=n(827),D=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.bookId=e.params.id,n.state={showPanel:!1,isCalcMode:!0,nodeHeights:[],nodes:[],showViewerPreference:!1,fluid:!1,isTouchMode:!1},n.handleViewerClick=n.handleViewerClick.bind(n),n.handelViewerMouseMove=n.handelViewerMouseMove.bind(n),n.handleProgressChange=n.handleProgressChange.bind(n),n.handleResize=n.handleResize.bind(n),n.deboundedHandleResize=v["default"].debounce(n.handleResize,500,{maxWait:1e3}),n}return l(t,e),u(t,[{key:"isViewFluid",value:function(){return C["default"].getScreenInfo().view.width<700}},{key:"isTouchMode",value:function(){return C["default"].getScreenInfo().view.width<700}},{key:"setProgress",value:function(e){S["default"].setProgress(this.bookId,{percentage:e})}},{key:"handelViewerMouseMove",value:function(e){if(!this.state.isCalcMode&&!this.state.isTouchMode){var t=e.pageY-document.body.scrollTop,n=C["default"].getScreenInfo().view.width-e.pageX;this.setState({showPanel:t<90,showPageInfo:n<100})}}},{key:"handleResize",value:function(){this.setState({fluid:this.isViewFluid(),isTouchMode:this.isTouchMode()})}},{key:"handleProgressChange",value:function(e){this.setProgress(e)}},{key:"handleViewerClick",value:function(){this.state.isTouchMode&&this.setState({showPanel:!this.state.showPanel,showPageInfo:!this.state.showPageInfo})}},{key:"calcDom",value:function(){var e=this;this.setState({isCalcMode:!0},function(){var t=e.bookPageWithRawHtml.getContentHtml(),n=b.getNodeHeights(t.childNodes);console.log("calc done"),e.setState({nodeHeights:n,isCalcMode:!1})})}},{key:"addEventListeners",value:function(){window.addEventListener("resize",this.deboundedHandleResize)}},{key:"removeEventListeners",value:function(){window.removeEventListener("resize",this.deboundedHandleResize)}},{key:"shouldComponentUpdate",value:function(e,t){return!v["default"].isEqual(this.state,t)||!v["default"].isEqual(this.props,e)}},{key:"componentWillReceiveProps",value:function(e,t){var n=""===this.props.rawBookContent&&""!==e.rawBookContent||0===this.state.nodes.length&&""!==this.props.rawBookContent;if(n){var o=b.markdownToNodeStringList(e.rawBookContent);this.setState({nodes:o,fluid:this.isViewFluid(),isTouchMode:this.isTouchMode()})}}},{key:"componentDidUpdate",value:function(e,t){var n=0!==this.state.nodes.length&&0===t.nodes.length,o=this.state.fluid!==t.fluid;(n||o)&&this.calcDom()}},{key:"componentDidMount",value:function(){this.props.loadBook(this.bookId,{withContent:!0}),this.props.fetchProgress(this.bookId),this.addEventListeners()}},{key:"componentWillUnmount",value:function(){this.removeEventListeners()}},{key:"renderViewPanel",value:function(){var e=this;return(this.state.showPanel||this.state.showViewerPreference)&&s["default"].createElement(_["default"],{title:this.props.book.title,showViewerPreference:this.state.showViewerPreference,onPrefVisibilityChange:function(t){e.setState({showViewerPreference:t})}})}},{key:"renderBook",value:function(){var e=this,t=this.state,n=t.nodes,o=t.nodeHeights,r=t.fluid,i=t.showPageInfo,a=this.props.progress;return 0===n.length?s["default"].createElement(I["default"],{text:"书籍获取中",center:!0}):this.state.isCalcMode?s["default"].createElement(O["default"],{nodes:n,ref:function(t){e.bookPageWithRawHtml=t},fluid:r}):"undefined"==typeof a?s["default"].createElement(I["default"],{text:"阅读进度获取中 ...",center:!0}):s["default"].createElement(y["default"],{nodeHeights:o,nodes:this.state.nodes,pageCount:5,initialProgress:a,pageHeight:900,onProgressChange:this.handleProgressChange,fluid:r,showPageInfo:i})}},{key:"render",value:function(){return s["default"].createElement(T["default"],{bodyClass:"viewer",title:this.props.book.title},s["default"].createElement("div",{onClick:this.handleViewerClick,onMouseMove:this.handelViewerMouseMove},this.renderViewPanel(),this.renderBook()))}}]),t}(f.Component);D=L([(0,j["default"])(V)],D);var z=function(e,t){var n=t.params.id,o=N.common.entity("books",n)(e),r=N.common.entity("booksProgress",n)(e);return{book:o,rawBookContent:v["default"].get(o,"content.raw",""),progress:v["default"].get(r,"percentage"),session:e.session}};t["default"]=(0,p.connect)(z,{loadBook:g.loadBook,fetchProgress:g.fetchProgress,openConfirmModal:g.openConfirmModal})(D)},588:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e){console.log("dom ready, getNodeHeights");var t=[];return Array.prototype.forEach.call(e,function(e,n){"gb-line"!==e.className&&console.error("Unsupported content found!"),t.push(e.clientHeight)}),t}function i(e){console.log("start md");var t=(0,l["default"])(e,{gfm:!0,breaks:!0});console.log("done marked");var n=Array.prototype.map.call((0,c["default"])(t),function(e,t){return 3===e.nodeType&&"\n"===e.nodeValue?null:"P"===e.tagName?'<p class="gb-line">'+e.innerHTML+"</p>":'<div class="gb-line">'+e.outerHTML+"</div>"}).filter(function(e){return e});return console.log("end md"),n}Object.defineProperty(t,"__esModule",{value:!0}),t.getNodeHeights=r,t.markdownToNodeStringList=i;var a=n(351),l=o(a),u=n(327),c=o(u)},589:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=n(1),f=o(c),s=n(13),p=n(180),d=o(p),y=n(4),h=o(y),b=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":u(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},g=n(825),m=function(e){function t(e){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return a(t,e),l(t,[{key:"render",value:function(){return f["default"].createElement("div",{styleName:"viewer-preference"},f["default"].createElement("ul",{className:"options"},f["default"].createElement("li",{styleName:"option-font-size"},f["default"].createElement("span",null,"A-"),f["default"].createElement("span",null,"A+")),f["default"].createElement("li",{styleName:"option-scroll"},f["default"].createElement("span",{className:"label"},"滚动模式"),f["default"].createElement(d["default"],{value:!0})),f["default"].createElement("li",{styleName:"option-theme"},f["default"].createElement("span",{style:{background:"#fff"}},"theme1"),f["default"].createElement("span",{style:{background:"#eee"}},"theme2"),f["default"].createElement("span",{style:{background:"#222"}},"theme3"))))}}]),t}(c.Component);m=b([(0,h["default"])(g)],m),t["default"]=(0,s.connect)()(m)},590:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=n(1),f=o(c),s=n(4),p=o(s),d=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":u(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},y=n(826),h=function(e){function t(e){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return a(t,e),l(t,[{key:"render",value:function(){var e=this.props,t=e.current,n=e.total,o=(t/n*100).toFixed(2)+"%";return this.props.visible&&f["default"].createElement("div",{styleName:"loc-info"},f["default"].createElement("div",null,f["default"].createElement("strong",null,t),"/",n),f["default"].createElement("div",{styleName:"sub-info"},o))}}]),t}(c.Component);h=d([(0,p["default"])(y)],h),t["default"]=h},591:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=n(1),f=o(c),s=n(17),p=n(35),d=o(p),y=n(273),h=o(y),b=n(589),g=o(b),m=n(4),v=o(m),w=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":u(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},_=n(828),P=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showViewerPreference:!1},n.handlePrefClick=n.handlePrefClick.bind(n),n}return a(t,e),l(t,[{key:"handlePrefClick",value:function(){this.props.onPrefVisibilityChange(!this.props.showViewerPreference)}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.title,n=e.showViewerPreference;return f["default"].createElement("div",{styleName:"viewer-panel"},f["default"].createElement("div",{styleName:"container"},f["default"].createElement("div",{styleName:"back"},f["default"].createElement(s.Link,{to:"/"},f["default"].createElement(d["default"],{name:"back"}),f["default"].createElement("span",null,"返回"))),f["default"].createElement("span",{styleName:"title"},t),f["default"].createElement("div",{onClick:this.handlePrefClick,styleName:"preference"},f["default"].createElement(d["default"],{name:"preference"})),f["default"].createElement(h["default"],null,n?f["default"].createElement(g["default"],null):null)))}}]),t}(c.Component);P=w([(0,v["default"])(_)],P),t["default"]=P},823:function(e,t){e.exports={pages:"pages_Lkz-8","pages--fluid":"pages--fluid_1DXUA pages_Lkz-8"}},824:function(e,t){e.exports={content:"content_1mydI",page:"page_1SU4h","page--fluid":"page--fluid_vX8rQ page_1SU4h","page--init":"page--init_8DZFB","page-no":"page-no_1jbV-"}},825:function(e,t){e.exports={"viewer-preference":"viewer-preference_1FNJZ",option:"option_19FXW","option-font-size":"option-font-size_18ONG option_19FXW","option-scroll":"option-scroll_3agtO option_19FXW",label:"label_3HLPp",switcher:"switcher_3T9K_","option-theme":"option-theme_38bUg option_19FXW"}},826:function(e,t){e.exports={scrollbar:"scrollbar_3vHlt",button:"button_1vdqU",track:"track_2FLTA","track--past":"track--past_3YKd4 track_2FLTA","loc-info":"loc-info_377Vu","sub-info":"sub-info_3qI5u"}},827:function(e,t){},828:function(e,t){e.exports={"viewer-panel":"viewer-panel_107MY",container:"container_3L78R",back:"back_1mVrC",title:"title_3MIpP",preference:"preference_2JQRi"}}});