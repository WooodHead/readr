webpackJsonp([5],{64:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=n(1),c=o(s),f=n(4),p=o(f),d=n(8),y=o(d),h=function(e,t,n,o){var r,i=arguments.length,l=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":u(Reflect))&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(i<3?r(l):i>3?r(t,n,l):r(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l},b=n(70),g=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={dynamicText:""},n}return l(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this;this.intervalId=setInterval(function(){3===e.state.dynamicText.length?e.setState({dynamicText:""}):e.setState({dynamicText:e.state.dynamicText+"."})},500)}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalId)}},{key:"render",value:function(){var e=this.props,t=e.text,n=e.center,o=this.state.dynamicText,r=(0,y["default"])({"loading-wrap--center":n,"loading-wrap":!n});return c["default"].createElement("div",{styleName:r},c["default"].createElement("span",{styleName:"text-loading"},t+o))}}]),t}(s.Component);g=h([(0,p["default"])(b)],g),g.defaultProps={text:"加载中"},t["default"]=g},65:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(64),i=o(r);t["default"]=i["default"]},70:function(e,t){e.exports={"text-loading":"text-loading_3efqh","loading-wrap":"loading-wrap_htyYz","loading-wrap--center":"loading-wrap--center_3PEIh"}},179:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=n(1),c=o(s),f=n(4),p=o(f),d=function(e,t,n,o){var r,i=arguments.length,l=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":u(Reflect))&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(i<3?r(l):i>3?r(t,n,l):r(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l},y=n(215),h=function(e){function t(e){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return l(t,e),a(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.props,n=t.value,o=t.className;"string"==typeof this.props.value&&(n="1"===n||"true"===n);var r=Boolean(n)?"on":"off";return c["default"].createElement("div",{className:o||"",styleName:"switcher-wrap"},this.props.title&&c["default"].createElement("span",null,this.props.title),c["default"].createElement("div",{onClick:function(t){if(e.props.onChange){var n=void 0;if(e.props.options){var o=e.props.options.map(function(e){return e.value}).indexOf(e.props.value);1===o?n=e.props.options[0].value:0===o?n=e.props.options[1].value:(n=e.props.options[0].value,console.error("当前数据有误，将使用默认数据！"))}else"string"==typeof e.props.value?console.error("没有给 options 时必须使用布尔型的 value！"):n=!e.props.value;e.props.onChange(n)}},styleName:"switcher--"+r},c["default"].createElement("div",{styleName:"switcher-button"}),c["default"].createElement("div",{styleName:"switcher-track"})))}}]),t}(s.Component);h=d([(0,p["default"])(y,{allowMultiple:!0})],h),t["default"]=h},180:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(179),i=o(r);t["default"]=i["default"]},215:function(e,t){e.exports={"switcher-wrap":"switcher-wrap_3UMAU",switcher:"switcher_G3n4_","switcher--off":"switcher--off_1EoOU","switcher--on":"switcher--on_2xiwO","switcher-button":"switcher-button_2kHGL","switcher-track":"switcher-track_xvhjg"}},275:function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=n(1),f=r(c),p=n(583),d=r(p),y=n(584),h=o(y),b=n(5),g=r(b),m=n(8),v=r(m),w=n(4),_=r(w),P=n(588),k=r(P),O=function(e,t,n,o){var r,i=arguments.length,l=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":s(Reflect))&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(i<3?r(l):i>3?r(t,n,l):r(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l},j=n(823),E=function(e){function t(e){i(this,t);var n=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={scrollTop:0,currentPage:1},n.handleScroll=n.handleScroll.bind(n),n.deboundedHandleScroll=g["default"].debounce(n.handleScroll,200,{maxWait:1e3}),n}return a(t,e),u(t,[{key:"handleScroll",value:function(){if(!this.props.isCalcMode){var e=this.calcPages(),t=e.pages,n=e.totalHeight,o=this.props.onProgressChange,r=document.body.scrollTop,i=h.percentageToPage(r/n,t.length);o&&o(r/n),this.setState({currentPage:i})}}},{key:"addEventListeners",value:function(){window.addEventListener("scroll",this.deboundedHandleScroll)}},{key:"removeEventListeners",value:function(){window.removeEventListener("scroll",this.deboundedHandleScroll),console.log("removed")}},{key:"calcPages",value:function(){var e=this.props,t=e.nodeHeights,n=e.nodes,o=e.pageHeight,r=h.groupNodesByPage(n,t,o);return{pages:r,totalHeight:r.length*o}}},{key:"scrollPage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=e.pageHeight,n=e.initialPage,o=e.initialProgress,r=this.calcPages(),i=r.totalHeight,l=0;o?l=i*o:n&&(l=t*(n-1)),document.body.scrollTop=l}},{key:"componentWillReceiveProps",value:function(e,t){var n=this.props.initialProgress!==e.initialProgress;n&&this.scrollPage(e)}},{key:"componentDidMount",value:function(){this.scrollPage(),this.addEventListeners()}},{key:"componentWillUnmount",value:function(){this.removeEventListeners()}},{key:"render",value:function(){var e=this,t=this.calcPages(),n=t.pages,o=t.totalHeight,r=this.state.currentPage,i=this.props,l=i.pageCount,a=i.pageHeight,u=i.fluid,s=i.showPageInfo,c=i.isCalcMode,p=(0,v["default"])({pages:!u,"pages--fluid":u}),y=void 0,h=void 0;return c?(y=0,h=1):(y=r-Math.ceil(l/2),y=y<0?0:y,h=y+l),f["default"].createElement("div",null,f["default"].createElement("ul",{ref:function(t){e.bookPageListDom=t},styleName:p,style:{height:o}},g["default"].slice(n,y,h).map(function(t,n){return f["default"].createElement(d["default"],{key:n,page:t,pageHeight:a,fluid:u,ref:function(t){e.bookPage=t}})})),f["default"].createElement(k["default"],{visible:s,current:r,total:n.length}))}}]),t}(c.Component);E=O([(0,_["default"])(j)],E),t["default"]=E},581:function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=n(1),f=r(c),p=n(13),d=n(275),y=r(d),h=n(582),b=o(h),g=n(10),m=n(5),v=r(m),w=n(586),_=r(w),P=n(585),k=r(P),O=n(4),j=r(O),E=n(76),S=r(E),M=n(108),C=r(M),R=n(45),H=r(R),T=n(32),N=o(T),x=n(65),I=r(x),V=function(e,t,n,o){var r,i=arguments.length,l=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":s(Reflect))&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(i<3?r(l):i>3?r(t,n,l):r(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l},L=n(821),B=function(e){function t(e){i(this,t);var n=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.bookId=e.params.id,n.state={showPanel:!1,isCalcMode:!0,nodeHeights:[],nodes:[],showViewerPreference:!1,fluid:!1,isTouchMode:!1},n.handleViewerClick=n.handleViewerClick.bind(n),n.handelViewerMouseMove=n.handelViewerMouseMove.bind(n),n.handleProgressChange=n.handleProgressChange.bind(n),n.handleResize=n.handleResize.bind(n),n.deboundedHandleResize=v["default"].debounce(n.handleResize,500,{maxWait:1e3}),n}return a(t,e),u(t,[{key:"isViewFluid",value:function(){return C["default"].getScreenInfo().view.width<700}},{key:"isTouchMode",value:function(){return C["default"].getScreenInfo().view.width<700}},{key:"setProgress",value:function(e){S["default"].setProgress(this.bookId,{percentage:e})}},{key:"handelViewerMouseMove",value:function(e){if(!this.state.isCalcMode&&!this.state.isTouchMode){var t=e.pageY-document.body.scrollTop,n=C["default"].getScreenInfo().view.width-e.pageX;this.setState({showPanel:t<90,showPageInfo:n<100})}}},{key:"handleResize",value:function(){this.setState({fluid:this.isViewFluid(),isTouchMode:this.isTouchMode()})}},{key:"handleProgressChange",value:function(e){var t=this.props,n=t.isFetchingProgress,o=t.session.user.role,r="undefined"!=typeof n||this.props.isFetchingProgress!==!1;r&&"visitor"!==o&&this.setProgress(e)}},{key:"handleViewerClick",value:function(){this.state.isTouchMode&&this.setState({showPanel:!this.state.showPanel,showPageInfo:!this.state.showPageInfo})}},{key:"calcDom",value:function(){var e=this;this.setState({isCalcMode:!0},function(){var t=e.bookPageWithRawHtml.getContentHtml(),n=b.getNodeHeights(t.childNodes);console.log("calc done"),e.setState({nodeHeights:n,isCalcMode:!1})})}},{key:"addEventListeners",value:function(){window.addEventListener("resize",this.deboundedHandleResize)}},{key:"removeEventListeners",value:function(){window.removeEventListener("resize",this.deboundedHandleResize)}},{key:"shouldComponentUpdate",value:function(e,t){return!v["default"].isEqual(this.state,t)||!v["default"].isEqual(this.props,e)}},{key:"componentWillReceiveProps",value:function(e,t){var n=""===this.props.rawBookContent&&""!==e.rawBookContent||0===this.state.nodes.length&&""!==this.props.rawBookContent,o=this.props.session.determined===!1&&e.session.determined===!0;if(o&&"visitor"!==e.session.user.role&&this.props.fetchProgress(this.bookId),o&&"visitor"===e.session.user.role&&this.props.initializeBookProgress(),n){var r=b.markdownToNodeStringList(e.rawBookContent);this.setState({nodes:r,fluid:this.isViewFluid(),isTouchMode:this.isTouchMode()})}}},{key:"componentDidUpdate",value:function(e,t){var n=0!==this.state.nodes.length&&0===t.nodes.length,o=this.state.fluid!==t.fluid;(n||o)&&this.calcDom()}},{key:"componentDidMount",value:function(){var e=this.props.session;this.props.loadBook(this.bookId,{withContent:!0}),this.addEventListeners(),e.determined&&"visitor"!==e.user.role&&this.props.fetchProgress(this.bookId)}},{key:"componentWillUnmount",value:function(){this.removeEventListeners(),this.props.destroyBookProgress()}},{key:"renderViewPanel",value:function(){var e=this;return(this.state.showPanel||this.state.showViewerPreference)&&f["default"].createElement(_["default"],{title:this.props.book.title,showViewerPreference:this.state.showViewerPreference,onPrefVisibilityChange:function(t){e.setState({showViewerPreference:t})}})}},{key:"renderBook",value:function(){var e=this,t=this.state,n=t.nodes,o=t.nodeHeights,r=t.fluid,i=t.showPageInfo,l=this.props.progress;return 0===n.length?f["default"].createElement(I["default"],{text:"书籍获取中",center:!0}):this.state.isCalcMode?f["default"].createElement(k["default"],{nodes:n,ref:function(t){e.bookPageWithRawHtml=t},fluid:r}):f["default"].createElement(y["default"],{nodeHeights:o,nodes:this.state.nodes,pageCount:5,initialProgress:l,pageHeight:900,onProgressChange:this.handleProgressChange,fluid:r,showPageInfo:i})}},{key:"render",value:function(){return f["default"].createElement(H["default"],{bodyClass:"viewer",title:this.props.book.title},f["default"].createElement("div",{onClick:this.handleViewerClick,onMouseMove:this.handelViewerMouseMove},this.renderViewPanel(),this.renderBook()))}}]),t}(c.Component);B=V([(0,j["default"])(L)],B);var D=function(e,t){var n=t.params.id,o=N.common.entity("books",n)(e);return{book:o,rawBookContent:v["default"].get(o,"content.raw",""),progress:e.components.viewer.bookProgress.percentage,isFetchingProgress:e.components.viewer.bookProgress.isFetching,session:e.session}};t["default"]=(0,p.connect)(D,{loadBook:g.loadBook,fetchProgress:g.fetchProgress,openConfirmModal:g.openConfirmModal,initializeBookProgress:g.initializeBookProgress,destroyBookProgress:g.destroyBookProgress})(B)},582:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e){console.log("dom ready, getNodeHeights");var t=[];return Array.prototype.forEach.call(e,function(e,n){"gb-line"!==e.className&&console.error("Unsupported content found!"),t.push(e.clientHeight)}),t}function i(e){console.log("start md");var t=(0,a["default"])(e,{gfm:!0,breaks:!0});console.log("done marked");var n=Array.prototype.map.call((0,s["default"])(t),function(e,t){return 3===e.nodeType&&"\n"===e.nodeValue?null:"P"===e.tagName?'<p class="gb-line">'+e.innerHTML+"</p>":'<div class="gb-line">'+e.outerHTML+"</div>"}).filter(function(e){return e});return console.log("end md"),n}Object.defineProperty(t,"__esModule",{value:!0}),t.getNodeHeights=r,t.markdownToNodeStringList=i;var l=n(350),a=o(l),u=n(326),s=o(u)},583:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=n(1),c=o(s),f=n(8),p=o(f),d=n(4),y=o(d),h=function(e,t,n,o){var r,i=arguments.length,l=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":u(Reflect))&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(i<3?r(l):i>3?r(t,n,l):r(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l},b=n(822),g=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.page,o=n.nodes,r=n.meta,i=t.pageHeight,l=t.fluid,a={position:"absolute",top:i*(r.pageNo-1),height:i||"auto"},u=(0,p["default"])({page:!l,"page--fluid":l});return c["default"].createElement("li",{styleName:u,style:a},c["default"].createElement("div",{style:{marginTop:r.offset},styleName:"content",dangerouslySetInnerHTML:{__html:o.join("")},ref:function(t){e.bookPageDom=t}}),c["default"].createElement("div",{styleName:"page-no"},r.pageNo))}}]),t}(s.Component);g=h([(0,y["default"])(b)],g),t["default"]=g},584:function(e,t){"use strict";function n(e){var t=e.pageIndex,n=e.pageHeight,o=e.nodeHeights,r=0,i=0,l=void 0;if(0!==t){for(var a=0;a<=n*t;)a+=o[i],i++;r=a-o[i-1]-t*n,l=i-1}else l=0;return{offset:r,nodeStartIndex:l}}function o(e){var t=e.pageIndex,o=e.nodes,r=e.pageHeight,i=e.nodeHeights,l=n({pageIndex:t,pageHeight:r,nodeHeights:i}),a=l.offset,u=l.nodeStartIndex,s=u,c=void 0,f=[],p=a+i[u];if(s++,p<r){for(;p<=r&&s!==o.length;)p+=i[s],s++;c=s-1}else c=u;for(var d=u;d<=c&&d<=o.length-1;d++)f.push(o[d]);return{pageNodes:f,offset:a}}function r(e,t,n){var r=[],i=t.reduce(function(e,t){return e+t},0),l=Math.ceil(i/n);if(console.log("todo: group nodes"),0===t.length)return[{nodes:e,meta:{pageNo:1,offset:0}}];for(var a=0;a<l;a++){var u=o({pageIndex:a,nodes:e,nodeHeights:t,pageHeight:n}),s=u.pageNodes,c=u.offset;r.push({nodes:s,meta:{pageNo:a+1,offset:c}})}return r}function i(e,t){return e>1?(console.error("Wrong parameter!"),null):parseInt(e*t)+1}Object.defineProperty(t,"__esModule",{value:!0}),t.groupNodesByPage=r,t.percentageToPage=i},585:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=n(1),s=o(u),c=n(275),f=o(c),p=function(e){function t(e){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return l(t,e),a(t,[{key:"getContentHtml",value:function(){return this.bookPageList.bookPage.bookPageDom}},{key:"render",value:function(){var e=this,t=this.props,n=t.fluid,o=t.nodes;return s["default"].createElement(f["default"],{fluid:n,nodes:o,nodeHeights:[],pageCount:1,pageHeight:0,isCalcMode:!0,ref:function(t){e.bookPageList=t}})}}]),t}(u.Component);t["default"]=p},586:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=n(1),c=o(s),f=n(18),p=n(35),d=o(p),y=n(273),h=o(y),b=n(587),g=o(b),m=n(4),v=o(m),w=function(e,t,n,o){var r,i=arguments.length,l=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":u(Reflect))&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(i<3?r(l):i>3?r(t,n,l):r(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l},_=n(824),P=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showViewerPreference:!1},n.handlePrefClick=n.handlePrefClick.bind(n),n}return l(t,e),a(t,[{key:"handlePrefClick",value:function(){this.props.onPrefVisibilityChange(!this.props.showViewerPreference)}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.title,n=e.showViewerPreference;return c["default"].createElement("div",{styleName:"viewer-panel"},c["default"].createElement("div",{styleName:"container"},c["default"].createElement("div",{styleName:"back"},c["default"].createElement(f.Link,{to:"/"},c["default"].createElement(d["default"],{name:"back"}),c["default"].createElement("span",null,"返回"))),c["default"].createElement("span",{styleName:"title"},t),c["default"].createElement("div",{onClick:this.handlePrefClick,styleName:"preference"},c["default"].createElement(d["default"],{name:"preference"})),c["default"].createElement(h["default"],null,n?c["default"].createElement(g["default"],null):null)))}}]),t}(s.Component);P=w([(0,v["default"])(_)],P),t["default"]=P},587:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=n(1),c=o(s),f=n(13),p=n(180),d=o(p),y=n(4),h=o(y),b=function(e,t,n,o){var r,i=arguments.length,l=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":u(Reflect))&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(i<3?r(l):i>3?r(t,n,l):r(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l},g=n(825),m=function(e){function t(e){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return l(t,e),a(t,[{key:"render",value:function(){return c["default"].createElement("div",{styleName:"viewer-preference"},c["default"].createElement("ul",{className:"options"},c["default"].createElement("li",{styleName:"option-font-size"},c["default"].createElement("span",null,"A-"),c["default"].createElement("span",null,"A+")),c["default"].createElement("li",{styleName:"option-scroll"},c["default"].createElement("span",{className:"label"},"滚动模式"),c["default"].createElement(d["default"],{value:!0})),c["default"].createElement("li",{styleName:"option-theme"},c["default"].createElement("span",{style:{background:"#fff"}},"theme1"),c["default"].createElement("span",{style:{background:"#eee"}},"theme2"),c["default"].createElement("span",{style:{background:"#222"}},"theme3"))))}}]),t}(s.Component);m=b([(0,h["default"])(g)],m),t["default"]=(0,f.connect)()(m)},588:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=n(1),c=o(s),f=n(4),p=o(f),d=function(e,t,n,o){var r,i=arguments.length,l=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":u(Reflect))&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(l=(i<3?r(l):i>3?r(t,n,l):r(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l},y=n(826),h=function(e){function t(e){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return l(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.current,n=e.total,o=(t/n*100).toFixed(2)+"%";return this.props.visible&&c["default"].createElement("div",{styleName:"loc-info"},c["default"].createElement("div",null,c["default"].createElement("strong",null,t),"/",n),c["default"].createElement("div",{styleName:"sub-info"},o))}}]),t}(s.Component);h=d([(0,p["default"])(y)],h),t["default"]=h},821:function(e,t){},822:function(e,t){e.exports={content:"content_deYS4",page:"page_26Jj7","page--fluid":"page--fluid_20eQM page_26Jj7","page--init":"page--init_1VHVM","page-no":"page-no_2_187"}},823:function(e,t){e.exports={pages:"pages_2I79Z","pages--fluid":"pages--fluid_Ba_RX pages_2I79Z"}},824:function(e,t){e.exports={"viewer-panel":"viewer-panel_107MY",container:"container_3L78R",back:"back_1mVrC",title:"title_3MIpP",preference:"preference_2JQRi"}},825:function(e,t){e.exports={"viewer-preference":"viewer-preference_kLYVW",option:"option_3oCQo","option-font-size":"option-font-size_12HR2 option_3oCQo","option-scroll":"option-scroll_2EQ0n option_3oCQo",label:"label_iDRgB",switcher:"switcher_37lfk","option-theme":"option-theme_4kqAY option_3oCQo"}},826:function(e,t){e.exports={scrollbar:"scrollbar_3nI1M",button:"button_1ys08",track:"track_3l7Dy","track--past":"track--past_2_8Sr track_3l7Dy","loc-info":"loc-info_15nWB","sub-info":"sub-info_3bYj5"}}});