!function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(91)},function(e,t,n){e.exports=n(4)(1)},function(e,t,n){e.exports=n(4)(449)},function(e,t,n){"use strict";function o(e,t){return{type:"CHANGE_VALUE",name:e,value:t}}function r(e,t){return{type:"UPDATE_ELEMENT",name:e,data:t}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(25);Object.keys(a).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var i=n(26);Object.keys(i).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var u=n(27);Object.keys(u).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})}),t.changeValue=o,t.updateElement=r},function(e,t){e.exports=_react_lib},function(e,t,n){e.exports=n(4)(600)},function(e,t,n){e.exports=n(8)(678)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Textarea=t.SelectizeInput=t.Input=t.Button=void 0;var r=n(33),a=o(r),i=n(20),u=o(i),l=n(34),s=o(l),c=n(21),f=o(c);t.Button=a["default"],t.Input=u["default"],t.SelectizeInput=s["default"],t.Textarea=f["default"]},function(e,t){e.exports=_utils_lib},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="undefined"!=typeof window?window.location.origin:"http://localhost:3000",o={LOCAL:n+"/api/",DOUBAN_BOOKS:"https://api.douban.com/v2/book/"};t["default"]=o},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){var t=void 0;return e.forEach(function(e){t=e.className}),t}function l(e){"undefined"!=typeof e?document.body.className=e:document.body.removeAttribute("class")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=n(1),f=o(c),p=n(47),d=o(p),h=function(e){function t(){return r(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){return f["default"].createElement("div",{className:"react-body-class hidden"})}}]),t}(c.Component);t["default"]=(0,d["default"])(u,l)(h)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=function(e){function t(e){return r(this,t),a(this,Object.getPrototypeOf(t).call(this,e))}return i(t,e),u(t,[{key:"render",value:function(){var e=this.props.name,t=this.props.onClick,n=this.props.size;return s["default"].createElement("span",{className:"icon icon-"+e+" "+n,onClick:t})}}]),t}(l.Component);t["default"]=c},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=function(e){function t(){return r(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),u(t,[{key:"render",value:function(){var e=(this.props.isFluid?"container-fluid":"container")+(this.props.className?" "+this.props.className:"");return s["default"].createElement("div",{className:e},this.props.children)}}]),t}(l.Component);t["default"]=c},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=function(e){var t=Object.assign({},s,e),n=t.method,o=t.data,r=t.credentials,a=t.dataType,u={};if(n&&(u.method=n),r&&(u.credentials=r),"POST"===n){var l=void 0,c=void 0;"json"===a?(l="application/json",c=JSON.stringify(o)):"urlencoded"===a?(l="application/x-www-form-urlencoded",c=(0,i["default"])(o)):(a="urlencoded",l="application/x-www-form-urlencoded",c=(0,i["default"])(o),console.warn('Unsupported dataType used "urlencoded" instead!')),u.headers={"Content-Type":l,"Access-Control-Request-Method":"POST"},u.body=c}return"DELETE"===n&&(u.headers={"Access-Control-Request-Method":"DELETE"}),u};return fetch(e,n(t)).then(function(e){return e.json().then(function(t){return{json:t,response:e}})}).then(function(e){var n=e.json,o=e.response;return o.ok?(0,l["default"])(n,t.schema):Promise.reject(n)})}Object.defineProperty(t,"__esModule",{value:!0}),t.callApi=r,n(49);var a=n(43),i=o(a),u=n(22),l=o(u),s={dataType:"json",method:"GET",credentials:"same-origin"};t["default"]=r},function(e,t,n){e.exports=n(4)(455)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=n(5),f=n(58),p=o(f),d=function(e){function t(){return r(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),u(t,[{key:"render",value:function(){var e=this.props.title,t=this.props.moreLink?this.props.moreLink:null;return s["default"].createElement("div",{className:"book-list-section"},this.props.title&&s["default"].createElement("h2",{className:"section-title"},e),t?s["default"].createElement(c.Link,{className:"more",to:t},"查看更多"):null,s["default"].createElement(p["default"],{bookEntities:this.props.bookEntities}))}}]),t}(l.Component);t["default"]=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Schemas=void 0;var o=n(19),r=new o.Schema("books",{idAttribute:"id"}),a=new o.Schema("bookCollections",{idAttribute:"id"}),i=new o.Schema("profiles",{idAttribute:"id"}),u=new o.Schema("users",{idAttribute:"id"}),l=new o.Schema("doubanBooks",{idAttribute:"id"}),s=new o.Schema("books",{idAttribute:"bookId"}),c=new o.Schema("books",{idAttribute:"bookId"});t.Schemas={BOOK:r,BOOK_PROGRESS:s,BOOK_ARRAY:(0,o.arrayOf)(r),DOUBAN_BOOK_SEARCH_RESULTS:{books:(0,o.arrayOf)(l)},USER_ARRAY:(0,o.arrayOf)(u),MATCHED_BOOK_ARRAY:(0,o.arrayOf)(c),COLLECTION:a,COLLECTION_ARRAY:(0,o.arrayOf)(a),PROFILE:i}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e){return(0,p["default"])(h["default"].LOCAL+"collections",{method:"POST",data:e})}function a(e){return(0,p["default"])(h["default"].LOCAL+"books",{method:"POST",data:e})}function i(e){return(0,p["default"])(h["default"].LOCAL+"authors",{method:"POST",data:e})}function u(e){return(0,p["default"])(h["default"].LOCAL+"authors?q="+e)}function l(e){return(0,p["default"])(h["default"].LOCAL+"books?q="+e)}function s(e,t){(0,p["default"])(h["default"].LOCAL+"books/"+e+"/progress",{method:"POST",data:t})}function c(e){return(0,p["default"])(h["default"].LOCAL+"books/"+e,{method:"DELETE"})}Object.defineProperty(t,"__esModule",{value:!0}),t.addCollection=r,t.addBook=a,t.addAuthor=i,t.searchAuthors=u,t.searchBooks=l,t.setProgress=s,t.deleteBook=c;var f=n(13),p=o(f),d=n(9),h=o(d);t["default"]={addCollection:r,addBook:a,addAuthor:i,searchBooks:l,searchAuthors:u,setProgress:s,deleteBook:c}},function(e,t,n){e.exports=n(4)(673)},function(e,t,n){e.exports=n(8)(680)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=function(e){function t(e){return r(this,t),a(this,Object.getPrototypeOf(t).call(this,e))}return i(t,e),u(t,[{key:"render",value:function(){var e=this,t=this.props.className?"input-wrap "+this.props.className:"input-wrap",n=Object.assign({},this.props);return delete n.className,s["default"].createElement("div",{className:t},s["default"].createElement("input",{placeholder:this.props.placeholder,value:this.props.value,onChange:function(t){e.props.onChange(t)},type:this.props.type?this.props.type:"text",name:this.props.name?this.props.name:null}))}}]),t}(l.Component);t["default"]=c},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=function(e){function t(e){return r(this,t),a(this,Object.getPrototypeOf(t).call(this,e))}return i(t,e),u(t,[{key:"render",value:function(){var e=this,t=this.props.className?"textarea-wrap "+this.props.className:"textarea-wrap",n=Object.assign({},this.props);return delete n.className,s["default"].createElement("div",{className:t},s["default"].createElement("textarea",{placeholder:this.props.placeholder,value:this.props.value,onChange:function(t){e.props.onChange(t)},type:this.props.type?this.props.type:"text",name:this.props.name?this.props.name:null}))}}]),t}(l.Component);t["default"]=c},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){e=u["default"].camelizeKeys(e);var n=e;return"undefined"!=typeof t&&(n=Object.assign({},(0,a.normalize)(e,t))),n}Object.defineProperty(t,"__esModule",{value:!0});var a=n(19),i=n(48),u=o(i);t["default"]=r},function(e,t,n){e.exports=n(4)(38)},function(e,t,n){e.exports=n(4)(593)},function(e,t,n){"use strict";function o(e){return{bookId:e,CALL_API:{types:["BOOK_PROGRESS_REQUEST","BOOK_PROGRESS_SUCCESS","BOOK_PROGRESS_FAILURE"],endpoint:"books/"+e+"/progress",schema:l.Schemas.BOOK_PROGRESS}}}function r(){var e=arguments.length<=0||void 0===arguments[0]?"newest":arguments[0];return{flowType:e,CALL_API:{types:["BOOKS_REQUEST","BOOKS_SUCCESS","BOOKS_FAILURE"],endpoint:"books?exclude=content",schema:l.Schemas.BOOK_ARRAY}}}function a(e,t){var n="books/"+e;return t&&(n+="?fields="+t.join(",")),{bookId:e,CALL_API:{types:["BOOK_REQUEST","BOOK_SUCCESS","BOOK_FAILURE"],endpoint:n,schema:l.Schemas.BOOK}}}function i(){var e=arguments.length<=0||void 0===arguments[0]?"newest":arguments[0];return{flowType:e,CALL_API:{types:["COLLECTIONS_REQUEST","COLLECTIONS_SUCCESS","COLLECTIONS_FAILURE"],endpoint:"collections",schema:l.Schemas.COLLECTION_ARRAY}}}function u(e){return{collectionId:e,CALL_API:{types:["COLLECTION_REQUEST","COLLECTION_SUCCESS","COLLECTION_FAILURE"],endpoint:"collections/"+e,schema:l.Schemas.COLLECTION}}}Object.defineProperty(t,"__esModule",{value:!0}),t.fetchBookProgress=o,t.fetchBooks=r,t.fetchBook=a,t.fetchCollections=i,t.fetchCollection=u;var l=n(16)},function(e,t){"use strict";function n(e){var t=arguments.length<=1||void 0===arguments[1]?"success":arguments[1],n=arguments.length<=2||void 0===arguments[2]?5e3:arguments[2];return function(a,i){var u=Math.random().toFixed(8).substr(2);a(o(u,e,t)),setTimeout(function(){a(r(u))},n)}}function o(e,t){var n=arguments.length<=2||void 0===arguments[2]?"success":arguments[2];return{type:a,message:t,msgType:n,id:e}}function r(e){return{type:i,id:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.sendNotification=n,t.showNotification=o,t.hideNotification=r;var a=t.SHOW_NOTIFICATION="SHOW_NOTIFICATION",i=t.HIDE_NOTIFICATION="HIDE_NOTIFICATION"},function(e,t,n){"use strict";function o(){return{CALL_API:{types:["USER_AUTH_REQUEST","USER_AUTH_SUCCESS","USER_AUTH_FAILURE"],endpoint:"auth"}}}function r(e){return{CALL_API:{types:["PROFILE_REQUEST","PROFILE_SUCCESS","PROFILE_FAILURE"],endpoint:"users/"+e+"/profile",schema:u.Schemas.PROFILE}}}function a(){return{CALL_API:{types:["USER_LIST_REQUEST","USER_LIST_SUCCESS","USER_LIST_FAILURE"],endpoint:"users",schema:u.Schemas.USER_ARRAY}}}function i(){return{payload:"bookShelf",CALL_API:{types:["SHELF_REQUEST","SHELF_SUCCESS","SHELF_FAILURE"],endpoint:"user/books/shelf"}}}Object.defineProperty(t,"__esModule",{value:!0}),t.userAuth=o,t.fetchProfile=r,t.fetchUserList=a,t.fetchShelf=i;var u=n(16)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=n(5),f=n(50),p=function(e){function t(e){r(this,t);var n=a(this,Object.getPrototypeOf(t).call(this,e));return n.state={isDropdownMenuVisible:!1},n}return i(t,e),u(t,[{key:"toggleDropdownMenu",value:function(){this.setState({isDropdownMenuVisible:!this.state.isDropdownMenuVisible})}},{key:"render",value:function(){var e=this.props.username,t=this.props.isAdmin?this.props.isAdmin:!1;return s["default"].createElement("div",{className:"branding "+(this.props.className?this.props.className:"")},s["default"].createElement(f.Container,{className:"clearfix"},s["default"].createElement("div",null,s["default"].createElement("h1",{className:"logo left"},s["default"].createElement(c.Link,{to:"/"},"readr")),s["default"].createElement("div",{className:"nav left"},s["default"].createElement("ul",{className:"nav-links"},s["default"].createElement("li",null,s["default"].createElement(c.Link,{to:"/browse"},"浏览")),s["default"].createElement("li",null,s["default"].createElement(c.Link,{to:"/collections"},"书单")))),e?s["default"].createElement("div",{onMouseLeave:this.toggleDropdownMenu.bind(this),onMouseEnter:this.toggleDropdownMenu.bind(this),className:"nav right"},s["default"].createElement("span",{className:"recent-reading"},"最近阅读"),s["default"].createElement("span",{className:"username"},e,t?s["default"].createElement("span",{className:"badge-dark"},"Admin"):null),this.state.isDropdownMenuVisible?s["default"].createElement("ul",{onClick:this.toggleDropdownMenu.bind(this),className:"dropdown-menu"},t===!0?s["default"].createElement("li",null,s["default"].createElement("a",{href:"/console"},"控制台")):null,s["default"].createElement("li",null,s["default"].createElement(c.Link,{to:"/shelf"},"书架")),s["default"].createElement("li",null,s["default"].createElement(c.Link,{to:"/profile"},"个人主页")),s["default"].createElement("li",null,s["default"].createElement(c.Link,{to:"/settings"},"设置")),s["default"].createElement("li",null,s["default"].createElement("a",{href:"/logout"},"退出"))):null):s["default"].createElement("div",{className:"nav right"},s["default"].createElement("ul",{className:"nav-links"},s["default"].createElement("li",null,s["default"].createElement(c.Link,{to:"/signin"},"登录")),s["default"].createElement("li",null,s["default"].createElement(c.Link,{to:"/signup"},"注册")))))))}}]),t}(l.Component);t["default"]=p},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=function(e){function t(){return r(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),u(t,[{key:"render",value:function(){return s["default"].createElement("h1",null,"404")}}]),t}(l.Component);t["default"]=c},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=n(11),f=o(c),p=function(e){function t(){return r(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),u(t,[{key:"render",value:function(){var e=this.props.type?this.props.type:"success";return s["default"].createElement("div",null,this.props.visible&&s["default"].createElement("div",{className:("notification notification--"+e+" z1").trim()},s["default"].createElement(f["default"],{onClick:this.props.onRequestClose,name:"close"}),this.props.message))}}]),t}(l.Component);t["default"]=p},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=n(24),f=o(c),p=function(e){function t(e){return r(this,t),a(this,Object.getPrototypeOf(t).call(this,e))}return i(t,e),u(t,[{key:"render",value:function(){return s["default"].createElement(f["default"],{component:"div",transitionName:"fade",transitionEnterTimeout:300,transitionLeaveTimeout:300},this.props.children)}}]),t}(l.Component);t["default"]=p},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=n(5),f=function(e){function t(e){return r(this,t),a(this,Object.getPrototypeOf(t).call(this,e))}return i(t,e),u(t,[{key:"render",value:function(){var e=this,t=this.props.className?"btn "+this.props.className:"btn",n=this.props.size?this.props.size:"medium",o=this.props.isFluid?this.props.isFluid:!1,r=this.props.color?this.props.color:null,a=void 0;"small"===n?t+=" btn-small":"large"===n?t+=" btn-large":"medium"===n?t+=" btn-medium":console.error("Unsupport size!"),r&&(t+=" btn-"+r),o&&(t+=" btn-fluid"),a=this.props.to?function(t){t.preventDefault(),c.browserHistory.push(e.props.to)}:function(t){t.preventDefault(),e.props.onClick&&e.props.onClick(t)};var i=Object.assign({},this.props,{className:t},{onClick:a});return delete i.to,delete i.color,delete i.size,delete i.isFluid,s["default"].createElement("button",i,this.props.children)}}]),t}(l.Component);t["default"]=f},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(32),a=o(r);t["default"]=a["default"]},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=n(11),f=o(c),p=function(e){function t(e){r(this,t);var n=a(this,Object.getPrototypeOf(t).call(this,e));return n.state={showOptions:!1,focus:!1,value:"",expendedOptionIndex:0},n.hideOptions=n.hideOptions.bind(n),n.focusInput=n.focusInput.bind(n),n.showOptions=n.showOptions.bind(n),n}return i(t,e),u(t,[{key:"addValue",value:function(e){this.props.onValuesChange(this.props.values.concat(e)),this.props.onOptionsChange&&this.props.onOptionsChange(this.props.options.map(function(t){return t.value===e.value?Object.assign({},t,{disabled:!0}):t})),this.clearInputValue(),"undefined"!=typeof this.props.stayFocused&&this.props.stayFocused===!1||this.focusInput(),this.hideOptions()}},{key:"removeValue",value:function(e){var t=[],n=void 0;-1===e?(t=this.props.values.slice(0,this.props.values.length-1),n=this.props.values[this.props.values.length-1].value):t=this.props.values.filter(function(t,o){return n=t.value,o!==e}),this.props.onOptionsChange&&this.props.onOptionsChange(this.props.options.map(function(e){return e.value===n?Object.assign({},e,{disabled:!1}):e})),this.props.onValuesChange(t)}},{key:"clearInputValue",value:function(){this.props.onInputChange("")}},{key:"handleKeyPress",value:function(e){8!==e.keyCode||this.props.value||this.removeValue(-1)}},{key:"focusInput",value:function(){this.input.focus()}},{key:"hideOptions",value:function(){this.setState({showOptions:!1})}},{key:"showOptions",value:function(e){e.stopPropagation(),this.setState({showOptions:!0})}},{key:"componentDidMount",value:function(){window.addEventListener("click",this.hideOptions)}},{key:"componentDidUpdate",value:function(e,t){}},{key:"componentWillUnmount",value:function(){window.removeEventListener("click",this.hideOptions)}},{key:"render",value:function(){var e=this,t=this.props.label?this.props.label:null,n=this.props.value?this.props.value:"",o=this.props.values,r=this.props.options?this.props.options:[],a=o.length>0?0===n.length?16:16*n.length:"100%",i=o.length>0?"":this.props.placeholder,u="selectize-input"+(this.state.focus===!0?" focus":"")+(0===o.length?" empty":""),l=this.props.addNewValue?this.props.addNewValue:void 0;return s["default"].createElement("div",{className:("selectize-input-wrap "+(this.props.className?this.props.className:"")).trim()},t?s["default"].createElement("label",{className:"form-label"},t):null,s["default"].createElement("div",{className:u,onClick:function(t){e.focusInput(),e.showOptions(t)}},o.map(function(t,n){return s["default"].createElement("span",{key:n,className:"selectize-tag"},t.name,s["default"].createElement(f["default"],{size:"small",name:"close",onClick:function(t){e.removeValue(n)}}))}),s["default"].createElement("input",{style:{width:a},ref:function(t){e.input=t},value:n,placeholder:i,onBlur:function(t){e.setState({focus:!1})},onFocus:function(t){e.setState({focus:!0})},onChange:function(t){e.props.onInputChange(t.target.value)},onKeyDown:function(t){e.handleKeyPress(t)}})),this.state.showOptions?s["default"].createElement("ul",{className:"selectize-query-results"},r.map(function(t,n){return t.disabled?s["default"].createElement("li",{key:n,className:"disabled"},t.name):s["default"].createElement("li",{key:n,onClick:function(n){e.addValue(t),e.props.onOptionClick&&e.props.onOptionClick(t)}},s["default"].createElement("span",null,t.name))}),l?s["default"].createElement("li",{onClick:function(t){e.props.onAddNewValue(e.props.value)},className:"add"},"添加 ",s["default"].createElement("strong",null,this.props.value)):null):null)}}]),t}(l.Component);t["default"]=p},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=n(2),f=function(e){function t(e){return r(this,t),a(this,Object.getPrototypeOf(t).call(this,e))}return i(t,e),u(t,[{key:"render",value:function(){var e=this.props.on?"on":"off";return e+=" switcher",s["default"].createElement("div",{className:e},s["default"].createElement("div",{className:"switcher-button"}),s["default"].createElement("div",{className:"switcher-track"}))}}]),t}(l.Component);t["default"]=(0,c.connect)()(f)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){var n=[],o=!0,r=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(o=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);o=!0);}catch(l){r=!0,a=l}finally{try{!o&&u["return"]&&u["return"]()}finally{if(r)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance");
}}(),a=n(13),i=o(a),u=n(9),l=o(u);t["default"]=function(e){return function(t){return function(n){function o(e){var t=Object.assign({},n,e);return delete t.CALL_API,t}var a=n.CALL_API;if("undefined"==typeof a)return t(n);var u=a.endpoint,s=a.apiUrl,c=a.extendedOptions,f=a.types,p=a.schema,d=r(f,3),h=d[0],m=d[1],b=d[2];t(o({type:h})),"function"==typeof u&&(u=u(e.getState())),"undefined"==typeof s&&(s=l["default"].LOCAL);var y=s+u,v={schema:p};return"undefined"!=typeof c&&(v=Object.assign({},v,c)),(0,i["default"])(y,v).then(function(e){return t(o({response:e,type:m}))},function(e){return t(o({type:b,error:e.message||"Oops!"}))})}}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){return function(e){return function(t){switch(t.type){case"DOUBAN_BOOK_SEARCH_SUCCESS":t.response.result=t.response.result.books}e(t)}}}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(){var e=arguments.length<=0||void 0===arguments[0]?{books:{},users:{},bookCollections:{}}:arguments[0],t=arguments[1];return t.response&&t.response.entities?y["default"].merge({},e,t.response.entities):e}function i(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=arguments[1];return t.error&&t.payload?y["default"].assign({},e,r({},t.payload,{error:t.error})):t.response&&t.payload?y["default"].assign({},e,r({},t.payload,{data:t.response})):e}function u(){var e=arguments.length<=0||void 0===arguments[0]?null:arguments[0],t=arguments[1],n=(t.type,t.error);return n?t.error:e}function l(){var e=arguments.length<=0||void 0===arguments[0]?{user:{role:"visitor"}}:arguments[0],t=arguments[1];switch(t.type){case"USER_AUTH_REQUEST":return Object.assign({},e,{isFetching:!0});case"USER_AUTH_SUCCESS":return Object.assign({},e,{isFetching:!1,user:t.response});case"USER_AUTH_FAILURE":return Object.assign({},e,{isFetching:!1,user:t.response});default:return e}}function s(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=arguments[1];return"CHANGE_VALUE"===t.type?Object.assign({},e,r({},t.name,Object.assign({},e[t.name],{value:t.value}))):"UPDATE_ELEMENT"===t.type?Object.assign({},e,r({},t.name,Object.assign({},e[t.name],t.data))):e}Object.defineProperty(t,"__esModule",{value:!0});var c=n(14),f=n(18),p=n(39),d=o(p),h=n(40),m=o(h),b=n(6),y=o(b),v=(0,c.combineReducers)({books:(0,m["default"])({mapActionToKey:function(e){return e.flowType},types:["BOOKS_REQUEST","BOOKS_SUCCESS","BOOKS_FAILURE"]}),bookCollections:(0,m["default"])({mapActionToKey:function(e){return e.flowType},types:["COLLECTIONS_REQUEST","COLLECTIONS_SUCCESS","COLLECTIONS_FAILURE"]}),userList:(0,m["default"])({mapActionToKey:function(e){return"all"},types:["USER_LIST_REQUEST","USER_LIST_SUCCESS","USER_LIST_FAILURE"]}),doubanBookSearchResults:(0,m["default"])({mapActionToKey:function(e){return e.query},types:["DOUBAN_BOOK_SEARCH_REQUEST","DOUBAN_BOOK_SEARCH_SUCCESS","DOUBAN_BOOK_SEARCH_FAILURE"]}),bookSearchResults:(0,m["default"])({mapActionToKey:function(e){return e.query},types:["BOOK_SEARCH_REQUEST","BOOK_SEARCH_SUCCESS","BOOK_SEARCH_FAILURE"]})}),E=(0,c.combineReducers)({notifications:d["default"]}),O=(0,c.combineReducers)({payloads:i,components:E,elements:s,routing:f.routerReducer,entities:a,errorMessage:u,pagination:v,session:l});t["default"]=O},function(e,t){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],t=arguments[1];return"HIDE_NOTIFICATION"===t.type?e.map(function(e){return e.id===t.id?Object.assign({},e,{visible:!1}):e}):"SHOW_NOTIFICATION"===t.type?[].concat(n(e),[{visible:!0,message:t.message,type:t.msgType,id:t.id}]):e}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?{isFetching:!1,nextPageUrl:null,pageCount:0,ids:[]}:arguments[0],t=arguments[1];switch(t.type){case u:return Object.assign({},e,{isFetching:!0});case s:return Object.assign({},e,{isFetching:!1,ids:l["default"].union(e.ids,t.response.result),nextPageUrl:t.response.nextPageUrl,pageCount:e.pageCount+1});case c:return Object.assign({},e,{isFetching:!1});default:return e}}var n=e.types,o=e.mapActionToKey,a=i(n,3),u=a[0],s=a[1],c=a[2];return function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=arguments[1];switch(n.type){case u:case s:case c:var a=o(n);if("string"!=typeof a)throw new Error("Expected key to be a string.");var i=Object.assign({},e,r({},a,t(e[a],n)));return i;default:return e}}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var n=[],o=!0,r=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(o=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);o=!0);}catch(l){r=!0,a=l}finally{try{!o&&u["return"]&&u["return"]()}finally{if(r)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t["default"]=a;var u=n(6),l=o(u)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(){var e=void 0;return e="undefined"==typeof window?(0,a.createStore)(s["default"],{},(0,a.applyMiddleware)(u["default"],f["default"],d["default"])):"production"===v?(0,a.createStore)(s["default"],(0,m["default"])(),(0,a.applyMiddleware)(u["default"],f["default"],d["default"])):(0,a.createStore)(s["default"],(0,m["default"])(),(0,a.compose)((0,a.applyMiddleware)(u["default"],f["default"],d["default"],(0,y["default"])({collapsed:!0}))))}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r;var a=n(14),i=n(46),u=o(i),l=n(38),s=o(l),c=n(36),f=o(c),p=n(37),d=o(p),h=n(42),m=o(h),b=n(45),y=o(b),v="production"},function(e,t){"use strict";function n(){var e=void 0;return"undefined"!=typeof window.__INITIAL_STATE__&&(e=window.__INITIAL_STATE__),e}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e){var t=u["default"].cloneDeep(e),n="";for(var o in t)"object"===a(t[o])&&(t[o]=t[o].toString()),n=""+n+o+"="+t[o]+"&";return n.substr(0,n.length-1)}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};t["default"]=r;var i=n(6),u=o(i)},function(e,t){"use strict";function n(){var e=7/9;return window.innerWidth<=540?{screen:"phone",pageWidth:window.innerWidth,pageHeight:window.innerWidth/e}:{screen:"hd",pageWidth:700,pageHeight:700/e}}function o(){document.body.style.overflow="hidden"}function r(){document.body.style.overflow="visible"}Object.defineProperty(t,"__esModule",{value:!0}),t.getBookView=n,t.lockScroll=o,t.unlockScroll=r,t["default"]={getBookView:n,lockScroll:o,unlockScroll:r}},function(e,t){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function r(e,t,r,a){switch("undefined"==typeof e?"undefined":o(e)){case"object":return"function"==typeof e[a]?e[a].apply(e,n(r)):e[a];case"function":return e(t);default:return e}}function a(){function e(){P.forEach(function(e,t){var n=e.started,a=e.startedTime,u=e.action,s=e.prevState,c=e.error,p=e.took,d=e.nextState,m=P[t+1];m&&(d=m.prevState,p=m.started-n);var y=g(u),v="function"==typeof f?f(function(){return d},u):f,E=l(a),O=j.title?"color: "+j.title(y)+";":null,w="action "+(b?E:"")+" "+y.type+" "+(h?"(in "+p.toFixed(2)+" ms)":"");try{v?j.title?i.groupCollapsed("%c "+w,O):i.groupCollapsed(w):j.title?i.group("%c "+w,O):i.group(w)}catch(_){i.log(w)}var k=r(o,y,[s],"prevState"),S=r(o,y,[y],"action"),C=r(o,y,[c,s],"error"),N=r(o,y,[d],"nextState");k&&(j.prevState?i[k]("%c prev state","color: "+j.prevState(s)+"; font-weight: bold",s):i[k]("prev state",s)),S&&(j.action?i[S]("%c action","color: "+j.action(y)+"; font-weight: bold",y):i[S]("action",y)),c&&C&&(j.error?i[C]("%c error","color: "+j.error(c,s)+"; font-weight: bold",c):i[C]("error",c)),N&&(j.nextState?i[N]("%c next state","color: "+j.nextState(d)+"; font-weight: bold",d):i[N]("next state",d));try{i.groupEnd()}catch(_){i.log("—— log end ——")}}),P.length=0}var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.level,o=void 0===n?"log":n,a=t.logger,i=void 0===a?console:a,u=t.logErrors,c=void 0===u?!0:u,f=t.collapsed,p=t.predicate,d=t.duration,h=void 0===d?!1:d,m=t.timestamp,b=void 0===m?!0:m,y=t.transformer,v=t.stateTransformer,E=void 0===v?function(e){return e}:v,O=t.actionTransformer,g=void 0===O?function(e){return e}:O,w=t.errorTransformer,_=void 0===w?function(e){return e}:w,k=t.colors,j=void 0===k?{title:function(){return"#000000"},prevState:function(){return"#9E9E9E"},action:function(){return"#03A9F4"},nextState:function(){return"#4CAF50"},error:function(){return"#F20404"}}:k;if("undefined"==typeof i)return function(){return function(e){return function(t){return e(t)}}};y&&console.error("Option 'transformer' is deprecated, use stateTransformer instead");var P=[];return function(t){var n=t.getState;return function(t){return function(o){if("function"==typeof p&&!p(n,o))return t(o);var r={};P.push(r),r.started=s.now(),r.startedTime=new Date,r.prevState=E(n()),r.action=o;var a=void 0;if(c)try{a=t(o)}catch(i){r.error=_(i)}else a=t(o);if(r.took=s.now()-r.started,r.nextState=E(n()),e(),r.error)throw r.error;return a}}}}var i=function(e,t){return new Array(t+1).join(e)},u=function(e,t){return i("0",t-e.toString().length)+e},l=function(e){return"@ "+u(e.getHours(),2)+":"+u(e.getMinutes(),2)+":"+u(e.getSeconds(),2)+"."+u(e.getMilliseconds(),3)},s="undefined"!=typeof performance&&"function"==typeof performance.now?performance:Date;e.exports=a},function(e,t,n){e.exports=n(4)(657)},function(e,t,n){e.exports=n(4)(670)},function(e,t,n){e.exports=n(8)(752)},function(e,t,n){e.exports=n(8)(753)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Container=void 0;var r=n(12),a=o(r);t.Container=a["default"]},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=function(e){function t(){return r(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),u(t,[{key:"render",value:function(){return s["default"].createElement("div",{className:"loading-wrap"},s["default"].createElement("span",{className:"icon icon-loading"}))}}]),t}(l.Component);t["default"]=c},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=n(2),f=function(e){function t(e){return r(this,t),a(this,Object.getPrototypeOf(t).call(this,e))}return i(t,e),u(t,[{key:"render",value:function(){var e=this;return s["default"].createElement("div",{className:"nav-tab"},s["default"].createElement("ul",null,this.props.tabs.map(function(t,n){var o=null;return n===e.props.current&&(o="current"),s["default"].createElement("li",{className:o,key:n},t)})))}}]),t}(l.Component);t["default"]=(0,c.connect)()(f)},,,function(e,t,n){e.exports=n(4)(658)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=n(12),f=o(c),p=function(e){function t(){return r(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),u(t,[{key:"render",value:function(){return s["default"].createElement("div",{className:"colophon"},s["default"].createElement(f["default"],null,s["default"].createElement("p",null,"© 2015－2016 readrweb.com, all rights reserved")))}}]),t}(l.Component);t["default"]=p},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=n(7),f=function(e){function t(e){return r(this,t),a(this,Object.getPrototypeOf(t).call(this,e))}return i(t,e),u(t,[{key:"render",value:function(){var e=this.props.author,t=this.props.title,n=this.props.description,o=this.props.bookId;return s["default"].createElement("div",{className:"book-info-popup popup"},s["default"].createElement("h2",{className:"title"},t),s["default"].createElement("p",{className:"author"},e),s["default"].createElement(c.Button,{color:"blue",to:"/viewer/book/"+o},"阅读"),s["default"].createElement("div",{className:"description"},s["default"].createElement("p",null,n)))}}]),t}(l.Component);t["default"]=f},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=n(61),f=o(c),p=function(e){function t(){return r(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),u(t,[{key:"render",value:function(){return s["default"].createElement("ul",{className:"book-list clearfix"},this.props.bookEntities?this.props.bookEntities.map(function(e,t){var n=e.title,o=e.author,r=e.description,a=e.cover;return s["default"].createElement(f["default"],{id:e.id,key:t,title:n,author:o.map(function(e){return e.refData?e.refData.name:""}).join(", "),description:r,cover:a})}):null)}}]),t}(l.Component);t["default"]=p},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=n(60),f=o(c),p=function(e){function t(){return r(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),u(t,[{key:"render",value:function(){var e=this;return s["default"].createElement("ul",{className:"pages",style:{height:this.props.height}},this.props.pages.map(function(t,n){return"page"===t.type?s["default"].createElement(f["default"],{style:t.props.style,bookId:e.props.bookId,key:n,page:t}):void console.error("Not type page!")}))}}]),t}(l.Component);t["default"]=p},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=Object.assign||function(e){for(var t,n=1,o=arguments.length;o>n;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},f=function(e){function t(){return r(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),u(t,[{key:"render",value:function(){var e=this.props.page,t=this.props.style;return s["default"].createElement("li",{style:t},s["default"].createElement("div",{className:"content"},e.props.children.map(function(t,n){return"p"!==t.type&&console.error("Unsupported content found!"),s["default"].createElement("p",c({},0===n?{style:{marginTop:e.props.offset}}:{},{key:n}),t.props.children)})),s["default"].createElement("div",{className:"page-no"},e.props.pageNo))}}]),t}(l.Component);t["default"]=f},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=n(5),f=n(57),p=o(f),d=function(e){function t(){return r(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),u(t,[{key:"render",value:function(){return s["default"].createElement("li",{className:"book"},s["default"].createElement(c.Link,{to:"/book/"+this.props.id},s["default"].createElement("div",{className:"book-cover"},s["default"].createElement("img",{src:this.props.cover})),s["default"].createElement("div",{className:"book-meta"},s["default"].createElement("span",{title:this.props.title,className:"book-name"},this.props.title),s["default"].createElement("span",{className:"book-author"},this.props.author))),s["default"].createElement(p["default"],{bookId:this.props.id,title:this.props.title,author:this.props.author,description:this.props.description}))}}]),t}(l.Component);t["default"]=d},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=n(5),f=function(e){function t(){return r(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),u(t,[{key:"render",value:function(){var e=this.props.list,t=this.props.title,n=this.props.moreLink?this.props.moreLink:null;return s["default"].createElement("div",{className:"candy-box"},s["default"].createElement("h3",{className:"box-title"},t),n?s["default"].createElement(c.Link,{to:n},"查看更多"):null,s["default"].createElement("ul",null,e.map(function(e,t){return s["default"].createElement("li",{key:t},s["default"].createElement(c.Link,{to:e.link},e.name))})))}}]),t}(l.Component);t["default"]=f},,function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(65),a=o(r);t["default"]=a["default"]},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=n(2),f=n(35),p=o(f),d=function(e){function t(e){return r(this,t),a(this,Object.getPrototypeOf(t).call(this,e))}return i(t,e),u(t,[{key:"render",value:function(){return s["default"].createElement("div",{className:"viewer-preference"},s["default"].createElement("ul",{className:"options"},s["default"].createElement("li",{className:"option option-font-size"},s["default"].createElement("span",null,"A-"),s["default"].createElement("span",null,"A+")),s["default"].createElement("li",{className:"option option-scroll"},s["default"].createElement("span",{className:"label"},"滚动模式"),s["default"].createElement(p["default"],{on:!0})),s["default"].createElement("li",{className:"option option-theme"},s["default"].createElement("span",{style:{background:"#fff"}},"theme1"),s["default"].createElement("span",{style:{background:"#eee"}},"theme2"),s["default"].createElement("span",{style:{background:"#222"}},"theme3"))))}}]),t}(l.Component);t["default"]=(0,c.connect)()(d)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=n(2),f=function(e){function t(e){return r(this,t),a(this,Object.getPrototypeOf(t).call(this,e))}return i(t,e),u(t,[{key:"render",value:function(){return s["default"].createElement("div",{style:{height:400},className:"viewer-scrollbar"},s["default"].createElement("div",{className:"button"},s["default"].createElement("div",{className:"loc-info"},s["default"].createElement("div",null,s["default"].createElement("strong",null,this.props.current),"/",this.props.total),s["default"].createElement("div",{className:"sub-info"},"30.3%"))),s["default"].createElement("div",{style:{height:100},className:"track-past"}),s["default"].createElement("div",{style:{height:400},className:"track"}))}}]),t}(l.Component);t["default"]=(0,c.connect)()(f)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},s=n(1),c=o(s),f=n(2),p=n(28),d=o(p),h=n(50),m=n(56),b=o(m),y=n(3),v=n(55),E=o(v),O=function(e,t,n,o){var r,a=arguments.length,i=3>a?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":l(Reflect))&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var u=e.length-1;u>=0;u--)(r=e[u])&&(i=(3>a?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i},g=n(100),w=function(e){function t(e){return r(this,t),a(this,Object.getPrototypeOf(t).call(this,e))}return i(t,e),u(t,[{key:"componentDidMount",value:function(){this.props.userAuth()}},{key:"render",value:function(){var e=!1,t=null;return"visitor"!==this.props.session.user.role&&(e="admin"===this.props.session.user.role,t=this.props.session.user.username),c["default"].createElement("div",null,c["default"].createElement(d["default"],{isAdmin:e,username:t}),c["default"].createElement(h.Container,null,this.props.children),c["default"].createElement(b["default"],null))}}]),t}(s.Component);w=O([(0,E["default"])(g)],w),t["default"]=(0,f.connect)(function(e){return{notification:e.components.notification,session:e.session}},{userAuth:y.userAuth})(w)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(67),a=o(r);t["default"]=a["default"]},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){return{newestBooks:e.pagination.books.newest?e.pagination.books.newest.ids.map(function(t){return e.entities.books[t]}):[]}}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(1),c=o(s),f=n(2),p=n(35),d=o(p),h=n(15),m=o(h),b=n(3),y=function(e){
function t(e){return r(this,t),a(this,Object.getPrototypeOf(t).call(this,e))}return i(t,e),l(t,[{key:"componentDidMount",value:function(){this.props.fetchBooks()}},{key:"render",value:function(){return c["default"].createElement("div",{className:"archive page-content"},c["default"].createElement("div",{className:"page-header"},c["default"].createElement("ul",{className:"categories"},c["default"].createElement("li",{className:"current"},"全部"),c["default"].createElement("li",null,"全部"),c["default"].createElement("li",null,"全部"),c["default"].createElement("li",null,"全部"),c["default"].createElement("li",null,"全部"),c["default"].createElement("li",null,"全部"),c["default"].createElement("li",null,"全部")),c["default"].createElement("ul",{className:"left dropdown-menu"},c["default"].createElement("li",null,"时间"),c["default"].createElement("li",null,"热度"),c["default"].createElement("li",null,"名称")),c["default"].createElement("div",{className:"right"},c["default"].createElement("div",{className:"label"},"不显示我读过的"),c["default"].createElement(d["default"],{on:!1}))),c["default"].createElement(m["default"],{bookEntities:this.props.newestBooks}),c["default"].createElement("div",{className:"page-load-more"},"加载更多"))}}]),t}(s.Component);t["default"]=(0,f.connect)(u,{fetchBooks:b.fetchBooks,fetchCollections:b.fetchCollections})(y)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=n(2),f=n(3),p=function(e){function t(e){return r(this,t),a(this,Object.getPrototypeOf(t).call(this,e))}return i(t,e),u(t,[{key:"componentDidMount",value:function(){this.props.fetchCollections()}},{key:"render",value:function(){return s["default"].createElement("div",{className:"archived-collection"},s["default"].createElement("div",{className:"page-title"},"往期书单"),s["default"].createElement("ul",null,0!==this.props.newestCollections.length&&this.props.newestCollections.map(function(e,t){return s["default"].createElement("li",{key:t},s["default"].createElement("h2",null,e.name),s["default"].createElement("p",null,e.description))})),s["default"].createElement("div",{className:"page-load-more"},"加载更多"))}}]),t}(l.Component);t["default"]=(0,c.connect)(function(e){return{newestCollections:e.pagination.bookCollections.newest?e.pagination.bookCollections.newest.ids.map(function(t){return e.entities.bookCollections[t]}):[]}},{fetchCollections:f.fetchCollections})(p)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=n(2),f=n(3),p=n(51),d=o(p),h=n(7),m=n(6),b=o(m),y=n(10),v=o(y),E=function(e){function t(e){r(this,t);var n=a(this,Object.getPrototypeOf(t).call(this,e));return n.bookId=e.params.id,n}return i(t,e),u(t,[{key:"componentDidMount",value:function(){this.props.fetchBook(this.bookId)}},{key:"render",value:function(){var e=this.props.bookInfo?this.props.bookInfo:{};return s["default"].createElement("article",{className:"book-info content-container"},s["default"].createElement(v["default"],{className:"book-info"}),b["default"].isEmpty(e)?s["default"].createElement(d["default"],null):null,s["default"].createElement("header",{className:"book-info-header"},s["default"].createElement("div",{className:"left-col"},e.cover?s["default"].createElement("div",{className:"book-cover"},s["default"].createElement("img",{src:e.cover})):null),s["default"].createElement("div",{className:"right-col"},s["default"].createElement("h1",{className:"book-name"},e.title),s["default"].createElement("div",{className:"book-author"},s["default"].createElement("strong",null,"作者：",e.author?e.author.map(function(e){return e.refData?e.refData.name:""}).join(", "):"")),e.title?s["default"].createElement("div",null,s["default"].createElement(h.Button,{to:"/viewer/book/"+e.id,color:"blue"},"阅读"),s["default"].createElement(h.Button,null,"添加到书架"),s["default"].createElement(h.Button,null,"标记为已读"),s["default"].createElement(h.Button,null,"收藏")):null)),e.description?s["default"].createElement("div",null,s["default"].createElement("h2",null,"内容简介"),s["default"].createElement("p",null,e.description)):null)}}],[{key:"fetchData",value:function(e){var t=e.store,n=e.params;return t.dispatch((0,f.fetchBook)(n.id))}}]),t}(l.Component);t["default"]=(0,c.connect)(function(e,t){return{bookInfo:e.entities.books[t.params.id]}},{fetchBook:f.fetchBook})(E)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){return{shelf:b["default"].get(e.payloads.bookShelf,"data",[])}}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(1),c=o(s),f=n(2),p=n(3),d=n(15),h=o(d),m=n(6),b=o(m),y=function(e){function t(e){return r(this,t),a(this,Object.getPrototypeOf(t).call(this,e))}return i(t,e),l(t,[{key:"componentDidMount",value:function(){this.props.fetchShelf()}},{key:"render",value:function(){var e=this.props.shelf;return c["default"].createElement("div",null,c["default"].createElement(h["default"],{bookEntities:e,title:"我的书架"}))}}],[{key:"fetchData",value:function(e){var t=e.store;e.params;return t.dispatch((0,p.fetchShelf)())}}]),t}(s.Component);t["default"]=(0,f.connect)(u,{fetchShelf:p.fetchShelf})(y)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=n(2),f=n(7),p=n(3),d=n(15),h=o(d),m=function(e){function t(e){return r(this,t),a(this,Object.getPrototypeOf(t).call(this,e))}return i(t,e),u(t,[{key:"componentDidMount",value:function(){this.props.fetchCollection(this.props.params.id)}},{key:"render",value:function(){var e=this.props.bookCollection?this.props.bookCollection:{items:[]},t=e.items.filter(function(e){return e.refData}).map(function(e){return e.refData});return s["default"].createElement("div",{className:"collection"},s["default"].createElement("div",{className:"page-header"},s["default"].createElement("div",{className:"page-title"},e.name),s["default"].createElement("div",{className:"sub-title"},"10 本书"),s["default"].createElement("div",{className:"book-slider"},s["default"].createElement(h["default"],{bookEntities:t})),s["default"].createElement(f.Button,null,"收藏")),s["default"].createElement("div",{className:"page-content"},s["default"].createElement("p",null,e.description)))}}]),t}(l.Component);t["default"]=(0,c.connect)(function(e,t){return{bookCollection:e.entities.bookCollections[t.params.id]}},{fetchCollection:p.fetchCollection})(m)},,,,,,,function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){return{userBooks:[],newestBooks:e.pagination.books.newest?e.pagination.books.newest.ids.map(function(t){return e.entities.books[t]}):[],session:e.session,collection:function(){for(var t in e.entities.bookCollections)return e.entities.bookCollections[t]}()}}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},c=n(1),f=o(c),p=n(2),d=n(5),h=n(3),m=n(15),b=o(m),y=n(62),v=o(y),E=n(10),O=o(E),g=n(7),w=n(55),_=o(w),k=Object.assign||function(e){for(var t,n=1,o=arguments.length;o>n;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},j=function(e,t,n,o){var r,a=arguments.length,i=3>a?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":s(Reflect))&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var u=e.length-1;u>=0;u--)(r=e[u])&&(i=(3>a?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i},P=n(101),S=function(e){function t(e){r(this,t);var n=a(this,Object.getPrototypeOf(t).call(this,e));return n.state={showRecentReading:!1},n}return i(t,e),l(t,[{key:"componentDidMount",value:function(){this.props.fetchBooks(),this.props.fetchCollections()}},{key:"componentWillReceiveProps",value:function(e){this.props.session.isFetching&&!e.session.isFetching&&"visitor"!==e.session.user.role&&this.setState({showRecentReading:!0})}},{key:"render",value:function(){var e=this.props.newestBooks,t=this.props.collection?this.props.collection.name:"",n=this.props.collection?this.props.collection.items.filter(function(e){return Boolean(e.refData)}).map(function(e){return e.refData}):[];return f["default"].createElement("div",null,f["default"].createElement(O["default"],{className:"home"}),f["default"].createElement("div",{className:"row"},"visitor"!==this.props.session.user.role||this.props.session.isFetching?null:f["default"].createElement("div",{className:"hero-image"},f["default"].createElement("div",{className:"logo"},"Readr"),f["default"].createElement("div",{className:"page-title"},"新一代 web 阅读体验"),f["default"].createElement(g.Button,{to:"/signup"},"注册")),f["default"].createElement("div",{className:"col-md-8"},f["default"].createElement(b["default"],{bookEntities:e,title:"新书速递"}),f["default"].createElement(b["default"],{bookEntities:n,title:t,moreLink:"/collections/"+(this.props.collection?this.props.collection.id:"")}),f["default"].createElement(d.Link,k({},{styleName:"blue"},{className:"view-more",to:"/collections"}),"浏览更多书单2 >")),f["default"].createElement("div",{className:"col-md-4"},this.state.showRecentReading?f["default"].createElement(v["default"],{title:"最近阅读222",list:[]}):null)))}}],[{key:"fetchData",value:function(e){var t=e.store;return t.dispatch((0,h.fetchBooks)())}}]),t}(c.Component);S=j([(0,_["default"])(P)],S),t["default"]=(0,p.connect)(u,{fetchBooks:h.fetchBooks,fetchCollections:h.fetchCollections})(S)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(80),a=o(r);t["default"]=a["default"]},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){return{session:e.session,newestBooks:e.pagination.books.newest?e.pagination.books.newest.ids.map(function(t){return e.entities.books[t]}):[]}}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(1),c=o(s),f=n(2),p=n(52),d=o(p),h=n(3),m=n(15),b=o(m),y=n(7),v=function(e){function t(e){return r(this,t),a(this,Object.getPrototypeOf(t).call(this,e))}return i(t,e),l(t,[{key:"componentDidMount",value:function(){this.props.fetchBooks(),this.props.fetchShelf("15593187")}},{key:"render",value:function(){var e=this.props.newestBooks;return c["default"].createElement("div",{className:"profile"},c["default"].createElement("div",{className:"page-header"},c["default"].createElement("div",{className:"user-avatar"},c["default"].createElement("img",{src:"https://img3.doubanio.com/icon/ul43646706-43.jpg",alt:"user_avatar"})),c["default"].createElement("span",{className:"username"},"username"),c["default"].createElement("span",{className:"tagline"},"something to say"),c["default"].createElement(y.Button,null,"编辑")),c["default"].createElement(d["default"],{tabs:["收藏","读过","书评"],current:0}),c["default"].createElement("div",null,c["default"].createElement(b["default"],{title:"😄",bookEntities:e})))}}]),t}(s.Component);t["default"]=(0,f.connect)(u,{sendNotification:h.sendNotification,fetchBooks:h.fetchBooks,fetchCollections:h.fetchCollections,fetchShelf:h.fetchShelf})(v)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=n(2),f=n(3),p=n(30),d=o(p),h=function(e){function t(e){return r(this,t),a(this,Object.getPrototypeOf(t).call(this,e))}return i(t,e),u(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return s["default"].createElement("div",{className:"app-root"},this.props.notifications.filter(function(e){return e.visible}).length>0?s["default"].createElement("div",{className:"notifications"},this.props.notifications.map(function(e,t){return s["default"].createElement(d["default"],{key:t,type:e.type,message:e.message,visible:e.visible})})):null,this.props.children)}}]),t}(l.Component);t["default"]=(0,c.connect)(function(e){return{notifications:e.components.notifications}},{sendNotification:f.sendNotification})(h)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=n(2),f=n(3),p=n(52),d=o(p),h=n(10),m=o(h),b=n(35),y=o(b),v=n(6),E=o(v),O=function(e){function t(e){return r(this,t),a(this,Object.getPrototypeOf(t).call(this,e))}return i(t,e),u(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){if(e.session.isFetching===!1&&this.props.session.isFetching){var t=e.session.user.id;this.props.fetchProfile(t)}}},{key:"render",value:function(){var e=this.props.profile;return s["default"].createElement("div",{className:"settings"},s["default"].createElement(m["default"],{className:"page-settings"}),s["default"].createElement("div",{className:"page-content"},s["default"].createElement("div",{className:"page-header"},s["default"].createElement("h1",{className:"page-title"},"设置"),s["default"].createElement(d["default"],{tabs:["资料","个人主页"],current:0})),s["default"].createElement("ul",{className:"options"},s["default"].createElement("li",{className:"option"},s["default"].createElement("h2",null,"用户名"),s["default"].createElement("span",{className:"option-input"},"http://readrweb.com/@",s["default"].createElement("strong",null,e.username)),s["default"].createElement("span",{className:"edit"},"编辑")),s["default"].createElement("li",{className:"option"},s["default"].createElement("h2",null,"邮箱"),s["default"].createElement("span",{className:"option-input"},e.email),s["default"].createElement("span",{className:"edit"},"编辑")),s["default"].createElement("li",{className:"option"},s["default"].createElement("h2",null,"密码"),s["default"].createElement("span",{className:"option-input"},"******"),s["default"].createElement("span",{className:"edit"},"编辑")),s["default"].createElement("li",{className:"option"},s["default"].createElement("h2",null,"公开展示我的收藏"),s["default"].createElement("span",{className:"option-desc"},"关闭后其他用户将无法查看您的收藏"),s["default"].createElement(y["default"],{on:!0})))))}}]),t}(l.Component);t["default"]=(0,c.connect)(function(e){var t="visitor"!==e.session.user.role?e.session.user.id:"",n=t&&!E["default"].isEmpty(e.entities.profiles)?e.entities.profiles[t]:{};return{notification:e.notification,session:e.session,profile:n}},{sendNotification:f.sendNotification,userAuth:f.userAuth,fetchProfile:f.fetchProfile})(O)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(1),c=o(s),f=n(2),p=n(5),d=n(9),h=o(d),m=n(13),b=o(m),y=n(3),v=n(28),E=o(v),O=n(7),g=n(12),w=o(g),_=n(10),k=o(_),j=function(e){function t(e){a(this,t);var n=i(this,Object.getPrototypeOf(t).call(this,e));return n.state={login:"",password:""},n}return u(t,e),l(t,[{key:"handleSignin",value:function(e){var t=this;e.preventDefault();var n={login:this.state.login,password:this.state.password};(0,b["default"])(h["default"].LOCAL+"auth",{method:"POST",data:n}).then(function(e){t.props.sendNotification("登录成功！"),setTimeout(function(){p.browserHistory.push("/")},600)})["catch"](function(e){t.props.sendNotification(e.message)})}},{key:"handleInput",value:function(e){this.setState(r({},e.target.name,e.target.value))}},{key:"render",value:function(){return c["default"].createElement("div",null,c["default"].createElement(k["default"],{className:"signin"}),c["default"].createElement(E["default"],null),c["default"].createElement(w["default"],null,c["default"].createElement("form",{className:"content-container",action:h["default"].LOCAL+"auth",method:"post"},c["default"].createElement("h1",{className:"page-title"},"欢迎回来"),c["default"].createElement(O.Input,{onChange:this.handleInput.bind(this),value:this.state.login,name:"login",placeholder:"用户名或邮箱"}),c["default"].createElement(O.Input,{onChange:this.handleInput.bind(this),value:this.state.password,name:"password",placeholder:"密码",type:"password"}),c["default"].createElement(O.Button,{className:"z1",color:"blue",onClick:this.handleSignin.bind(this)},"登录"),c["default"].createElement("p",{className:"hint"},"没有账号？",c["default"].createElement(p.Link,{to:"/signup"},"注册")))))}}]),t}(s.Component);t["default"]=(0,f.connect)(function(e){return{notification:e.components.notification,user:e.user}},{sendNotification:y.sendNotification})(j)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(1),c=o(s),f=n(2),p=n(5),d=n(9),h=o(d),m=n(13),b=o(m),y=n(3),v=n(28),E=o(v),O=n(7),g=n(12),w=o(g),_=n(10),k=o(_),j=function(e){function t(e){a(this,t);var n=i(this,Object.getPrototypeOf(t).call(this,e));return n.state={username:"",email:"",password:""},n}return u(t,e),l(t,[{key:"handleSignup",value:function(e){var t=this;e.preventDefault();var n={username:this.state.username,email:this.state.email,password:this.state.password};(0,b["default"])(h["default"].LOCAL+"users",{method:"POST",data:n}).then(function(e){t.props.sendNotification("注册成功！"),setTimeout(function(){p.browserHistory.push("/")},600)},function(e){t.props.sendNotification(e.message,"error")})}},{key:"handleInput",value:function(e){this.setState(r({},e.target.name,e.target.value))}},{key:"render",value:function(){return c["default"].createElement("div",null,c["default"].createElement(k["default"],{className:"signup"}),c["default"].createElement(E["default"],null),c["default"].createElement(w["default"],null,c["default"].createElement("form",{className:"content-container",method:"post",action:"/signup"},c["default"].createElement("h1",{className:"page-title"},"加入 Readr"),c["default"].createElement(O.Input,{onChange:this.handleInput.bind(this),value:this.state.username,name:"username",placeholder:"用户名"}),c["default"].createElement(O.Input,{onChange:this.handleInput.bind(this),value:this.state.email,name:"email",placeholder:"邮箱"}),c["default"].createElement(O.Input,{onChange:this.handleInput.bind(this),value:this.state.password,name:"password",placeholder:"密码 ",type:"password"}),c["default"].createElement(O.Button,{className:"z1",color:"blue",onClick:this.handleSignup.bind(this)},"注册"),c["default"].createElement("p",{className:"hint"},"没有账号？",c["default"].createElement(p.Link,{to:"/signin"},"登录")))))}}]),t}(s.Component);t["default"]=(0,f.connect)(function(e){return{notification:e.components.notification,user:e.user}},{sendNotification:y.sendNotification})(j)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(88),a=o(r);t["default"]=a["default"]},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(1),c=r(s),f=n(5),p=n(2),d=n(14),h=n(24),m=r(h),b=n(11),y=r(b),v=n(51),E=r(v),O=n(89),g=r(O),w=n(59),_=r(w),k=n(99),j=o(k),P=n(44),S=n(96),C=n(98),N=n(3),T=n(17),M=r(T),R=n(10),A=r(R),L=n(6),I=r(L),x=n(64),B=r(x),U=n(31),D=r(U),F=n(66),H=r(F),K={fetchBook:N.fetchBook,userAuth:N.userAuth},V=function(e){function t(e){a(this,t);var n=i(this,Object.getPrototypeOf(t).call(this,e));return n.bookId=e.params.id,n.state={showPanel:!0,showProgressDialog:!1,isCalculatingDom:!1,isReadingMode:!1,isScrollMode:!0,isInitialProgressSet:!1,scrollTop:0,currentPage:0,calculatedPages:null,latestProgress:0,view:(0,P.getBookView)(),showViewerPreference:!1},n.toggleViewerPreference=n.toggleViewerPreference.bind(n),n}return u(t,e),l(t,[{key:"toggleViewerPreference",value:function(){this.setState({showViewerPreference:!this.state.showViewerPreference})}},{key:"scrollTo",value:function(e){var t=this.state.calculatedPages.props.children.length,n=this.state.calculatedPages.props.view.pageHeight,o=t*n;1>e?(this.setState({currentPage:j.percentageToPage(e,t),scrollTop:e*o}),document.body.scrollTop=t*n*e):(this.setState({currentPage:e,scrollTop:o*e/t}),document.body.scrollTop=n*e)}},{key:"addEventListeners",value:function(){var e=this;this.mapScrollTopToState=function(){e.setState({scrollTop:document.body.scrollTop})},this.mapWindowWidthToState=function(){e.setState({windowWidth:window.innerWidth})},this.mapViewToState=function(){e.setState({view:(0,P.getBookView)()})},this.checkAndSetProgress=function(){var t=e.props.book.pageNo;e.props.actions.fetchBookProgress(e.bookId).then(function(n){if(e.props.book.pageNo-t>5)e.setState({showProgressDialog:!0,latestProgress:e.props.book.percentage});else{var o=e.state.calculatedPages.props.children.length,r=o*e.state.view.pageHeight,a=e.state.scrollTop/r,i=j.percentageToPage(a,o),u={pageNo:i,pageSum:o,percentage:a};M["default"].setProgress(e.bookId,u)}})},this.deboundedSetProgress=I["default"].debounce(this.checkAndSetProgress,200),window.addEventListener("scroll",this.mapScrollTopToState),window.addEventListener("resize",this.mapWindowWidthToState),window.addEventListener("resize",this.mapViewToState)}},{key:"removeEventListeners",value:function(){window.removeEventListener("scroll",this.deboundedSetProgress),window.removeEventListener("scroll",this.mapScrollTopToState),window.removeEventListener("resize",this.mapWindowWidthToState),window.removeEventListener("resize",this.mapViewToState)}},{key:"toggleBookPanel",value:function(e){if("hd"===this.state.calculatedPages.props.view.screen){var t=e.pageY-document.body.scrollTop;90>t?this.setState({showPanel:!0}):this.setState({showPanel:!1})}}},{key:"clickToToggleBookPanel",value:function(){"phone"===this.state.calculatedPages.props.view.screen&&this.setState({showPanel:!this.state.showPanel})}},{key:"calculateDom",value:function(){var e=this.state.bookHtml,t=this.bookId,n=(0,P.getBookView)(),o=j.getNodeHeights(this.refs.bookHtml.childNodes),r=j.htmlToPages(e,o,n);(0,S.setCache)("book"+t+"_pages",JSON.stringify(r)),this.setState({isReadingMode:!0,isCalculatingDom:!1,calculatedPages:r})}},{key:"loadCalculatedPages",value:function(){var e=this.props.params.id,t=(0,S.getCache)("book"+e+"_pages");t?(t=JSON.parse(t),this.setState({isReadingMode:!0,calculatedPages:t,bookHtml:j.pagesToHtml(t)})):this.props.actions.fetchBook(e,["content"])}},{key:"componentWillUpdate",value:function(e,t){e.book&&e.book.content&&e.book.content.html&&!this.props.book.content&&this.setState({isCalculatingDom:!0,bookHtml:e.book.content.html}),(0,C.simpleCompareObjects)(this.state.view,t.view)||this.setState({isCalculatingDom:!0})}},{key:"componentDidUpdate",value:function(e,t){var n=this;this.state.isCalculatingDom&&!t.isCalculatingDom&&this.calculateDom(),
this.props.book&&this.props.book.percentage&&this.state.calculatedPages&&!this.state.isInitialProgressSet&&setTimeout(function(){n.scrollTo(n.props.book.percentage),n.setState({isInitialProgressSet:!0})},1)}},{key:"componentDidMount",value:function(){var e=this.props.actions,t=this.props.params.id;e.userAuth(),e.fetchBook(t),this.addEventListeners(),this.loadCalculatedPages()}},{key:"componentWillUnmount",value:function(){this.removeEventListeners(),this.setState({isInitialProgressSet:!1})}},{key:"renderBook",value:function(){var e=this.state.scrollTop,t=this.state.calculatedPages,n=this.props.params.id,o=t.props.view,r=t.props.children.length*o.pageHeight,a=j.percentageToPage(e/r,t.props.children.length),i=j.filterPages({startPage:a,offset:2,quantity:5,pages:t.props.children});return c["default"].createElement("div",{onClick:this.clickToToggleBookPanel.bind(this)},c["default"].createElement(_["default"],{height:r,view:o,bookId:n,pages:i}))}},{key:"hideProgressDialog",value:function(){this.setState({showProgressDialog:!1})}},{key:"render",value:function(){var e=this,t=this.props.book,n=this.state.view,o=[{text:"Yes","function":function(){e.scrollTo.call(e,e.state.latestProgress),e.hideProgressDialog.call(e)}},{text:"No","function":this.hideProgressDialog.bind(this)}];return c["default"].createElement("div",{className:"viewer viewer--"+n.screen,onMouseMove:this.toggleBookPanel.bind(this)},c["default"].createElement(A["default"],{className:"viewer"}),t.content||this.state.calculatedPages?null:c["default"].createElement(E["default"],null),this.state.showProgressDialog?c["default"].createElement(g["default"],{actions:o,content:"are you sure?"}):null,c["default"].createElement(m["default"],{component:"div",transitionName:"slide",transitionEnterTimeout:300,transitionLeaveTimeout:300},this.state.showPanel&&this.state.isReadingMode||this.state.showViewerPreference?c["default"].createElement("div",{className:"viewer-panel"},c["default"].createElement("div",{className:"container"},c["default"].createElement("div",{className:"back"},c["default"].createElement(f.Link,{to:"/"},c["default"].createElement(y["default"],{name:"back"}),c["default"].createElement("span",null,"返回"))),c["default"].createElement("span",{className:"title"},t.title),c["default"].createElement("div",{onClick:this.toggleViewerPreference,className:"preference"},c["default"].createElement(y["default"],{name:"font"})),c["default"].createElement("div",{className:"add"},"点击添加至书架"),c["default"].createElement(D["default"],null,this.state.showViewerPreference?c["default"].createElement(B["default"],null):null))):null),this.state.isCalculatingDom&&this.state.bookHtml?c["default"].createElement("ul",{className:"pages"},c["default"].createElement("li",null,c["default"].createElement("div",{ref:"bookHtml",className:"content",dangerouslySetInnerHTML:{__html:this.state.bookHtml}}))):null,this.state.isReadingMode?this.renderBook():null,c["default"].createElement(H["default"],{current:20,total:309}))}}]),t}(s.Component);t["default"]=(0,p.connect)(function(e,t){return{book:e.entities.books[t.params.id]?e.entities.books[t.params.id]:{},session:e.session}},function(e){return{actions:(0,d.bindActionCreators)(K,e)}})(V)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),c=function(e){function t(){return r(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),u(t,[{key:"render",value:function(){var e="dialog z1",t=this.props.className?e+" "+this.props.className:e,n=this.props.content,o=this.props.actions;return s["default"].createElement("div",{className:t},s["default"].createElement("p",null,n),s["default"].createElement("div",{className:"actions"},o.map(function(e,t){return s["default"].createElement("span",{key:t,onClick:e["function"]},e.text)})))}}]),t}(l.Component);t["default"]=c},,function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var r=n(23),a=n(1),i=o(a),u=n(5),l=n(93),s=o(l),c=n(2),f=n(18),p=n(41),d=o(p),h=(0,d["default"])(),m=(0,f.syncHistoryWithStore)(u.browserHistory,h);(0,r.render)(i["default"].createElement(c.Provider,{store:h},i["default"].createElement(u.Router,{history:m,routes:s["default"].props.children})),document.getElementById("root"))},,function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=o(r),i=n(5),u=n(29),l=o(u),s=n(87),c=o(s),f=n(85),p=o(f),d=n(86),h=o(d),m=n(71),b=o(m),y=n(68),v=o(y),E=n(81),O=o(E),g=n(82),w=o(g),_=n(72),k=o(_),j=n(84),P=o(j),S=n(69),C=o(S),N=n(73),T=o(N),M=n(70),R=o(M),A=n(83),L=o(A);t["default"]=a["default"].createElement(i.Router,null,a["default"].createElement(i.Route,{path:"/",component:L["default"]},a["default"].createElement(i.Route,{component:v["default"]},a["default"].createElement(i.IndexRoute,{component:O["default"]}),a["default"].createElement(i.Route,{path:"book/:id",component:b["default"]}),a["default"].createElement(i.Route,{path:"profile",component:w["default"]}),a["default"].createElement(i.Route,{path:"profile/:user",component:w["default"]}),a["default"].createElement(i.Route,{path:"shelf",component:k["default"]}),a["default"].createElement(i.Route,{path:"settings",component:P["default"]}),a["default"].createElement(i.Route,{path:"browse",component:C["default"]}),a["default"].createElement(i.Route,{path:"collections/:id",component:T["default"]}),a["default"].createElement(i.Route,{path:"collections",component:R["default"]})),a["default"].createElement(i.Route,{path:"signin",component:p["default"]}),a["default"].createElement(i.Route,{path:"signup",component:h["default"]}),a["default"].createElement(i.Route,{path:"viewer/book/:id",component:c["default"]}),a["default"].createElement(i.Route,{path:"*",component:l["default"]})))},,,function(e,t){"use strict";function n(e){"string"!=typeof e&&console.error("Name should be string!");var t=localStorage.getItem(e);return t||(t=!1),t}function o(e,t){"string"!=typeof e&&console.error("Name should be string!"),"string"!=typeof t&&console.error("Cache content should be string!");var n=!0;try{localStorage.setItem(e,t)}catch(o){console.error(o),n=!1}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.getCache=n,t.setCache=o},,function(e,t){"use strict";function n(e,t){var n=!0;try{for(var o in e)if(e[o]!==t[o]){n=!1;break}}catch(r){console.error(r),n=!1}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.simpleCompareObjects=n},function(e,t){"use strict";function n(e){for(var t=e.startPage,n=e.quantity,o=e.offset,r=e.pages,a=[];0>t-o;)o--;t-=o;for(var i=t;n+t>i&&i<r.length;i++){var u=r[i];a.push(u)}return a}function o(e,t,n){var o=n.pageHeight,r=u(e),a=s(r,t,o);return{type:"pages",props:{children:a,view:n}}}function r(e){for(var t=e.props.children.reduce(function(e,t){return e.concat(t.props.children)},[]),n=[],o=0,r=0;r<t.length;r++)t[r],t[r].props.index===o&&(n.push(t[r]),o++);var a=l(n);return a}function a(e){var t=[];return Array.prototype.forEach.call(e,function(e,n){"p"!==e.tagName.toLowerCase()&&console.error("Unsupported content found!"),t.push(e.clientHeight)}),t}function i(e,t){return e>1?(console.error("Wrong parameter!"),null):parseInt(e*t)+1}function u(e){var t=[],n=document.createElement("div"),o=void 0;n.innerHTML=e,o=n.childNodes;for(var r=0;r<o.length;r++)1==o[r].nodeType&&t.push({type:o[r].tagName.toLowerCase(),props:{children:o[r].innerHTML}});return t}function l(e){for(var t="",n=0;n<e.length;n++)"p"===e[n].type?t+="<p>"+e[n].props.children+"</p>":console.error("Unsupported node found!");return t}function s(e,t,n){var o=[],r=t.reduce(function(e,t){return e+t},0),a=Math.ceil(r/n);e=e.map(function(e,t){return e.props.index=t,e});for(var i=function(e){var o=0,r=0,a=void 0;if(0!==e){for(var i=0;n*e>=i;)i+=t[r],r++;o=i-t[r-1]-e*n,a=r-1}else a=0;return{offset:o,index:a}},u=function(o){var r=i(o),a=r.index,u=r.offset,l=a,s=void 0,c=[],f=u+t[a];if(l++,n>f){for(;n>=f&&l!==e.length;)f+=t[l],l++;s=l-1}else s=a;for(var p=a;s>=p&&p<=e.length-1;p++)c.push(e[p]);return[c,u]},l=0;a>l;l++){var s=u(l),c=s[0],f=s[1];o.push({props:{children:c,style:{top:l*n,position:"absolute",height:n},pageNo:l+1,offset:f},type:"page"})}return o}Object.defineProperty(t,"__esModule",{value:!0}),t.filterPages=n,t.htmlToPages=o,t.pagesToHtml=r,t.getNodeHeights=a,t.percentageToPage=i},function(e,t){},function(e,t){e.exports={blue:"home-blue-3O3fQ"}}]);